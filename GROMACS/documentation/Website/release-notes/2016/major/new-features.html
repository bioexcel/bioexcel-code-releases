
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>New and improved features &#8212; GROMACS 2018.3 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2018.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Performance improvements" href="performance.html" />
    <link rel="prev" title="Highlights" href="highlights.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="performance.html" title="Performance improvements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="highlights.html" title="Highlights"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">GROMACS 2018.3</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Release notes</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="new-and-improved-features">
<h1>New and improved features<a class="headerlink" href="#new-and-improved-features" title="Permalink to this headline">¶</a></h1>
<div class="section" id="changed-to-require-a-c-11-compiler">
<h2>Changed to require a C++11 compiler<a class="headerlink" href="#changed-to-require-a-c-11-compiler" title="Permalink to this headline">¶</a></h2>
<p>GROMACS now requires both a C++11 and C99 compiler. For details, see
the install guide.</p>
</div>
<div class="section" id="changed-to-support-only-cuda-5-0-and-more-recent-versions">
<h2>Changed to support only CUDA 5.0 and more recent versions<a class="headerlink" href="#changed-to-support-only-cuda-5-0-and-more-recent-versions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/1831">Issue 1831</a></p>
</div>
<div class="section" id="allowed-rcoulomb-rvdw-with-pme">
<h2>Allowed rcoulomb &gt; rvdw with PME<a class="headerlink" href="#allowed-rcoulomb-rvdw-with-pme" title="Permalink to this headline">¶</a></h2>
<p>GROMACS has had kernels that support Coulomb PME + cut-off LJ
with rcoulomb &gt; rvdw for a while, but these were only available via
PME load balancing. Now we allow this setup to be chosen also
through mdp options.</p>
</div>
<div class="section" id="added-optional-support-for-portable-hardware-locality-hwloc">
<h2>Added optional support for portable hardware locality (hwloc)<a class="headerlink" href="#added-optional-support-for-portable-hardware-locality-hwloc" title="Permalink to this headline">¶</a></h2>
<p>Added CMake support to detect and build GROMACS with hwloc, which
will improve GROMACS ability to recognize and take advantage of all
the available hardware. If hwloc is unavailable, GROMACS will fall back
on other detection routines.</p>
</div>
<div class="section" id="made-normal-mode-calculations-work-with-shells-and-vsites">
<h2>Made normal-mode calculations work with shells and vsites<a class="headerlink" href="#made-normal-mode-calculations-work-with-shells-and-vsites" title="Permalink to this headline">¶</a></h2>
<p>Implemented shells and vsites in normal-mode analysis in mdrun and in
analysis of eigenvalues and frequencies. The normal-mode analysis
is done on real atoms only and the shells are minimized at each step
of the analysis.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/879">Issue 879</a></p>
</div>
<div class="section" id="changed-pull-group-count-for-coords-stored-in-tpr-file">
<h2>Changed pull group count for coords stored in tpr file<a class="headerlink" href="#changed-pull-group-count-for-coords-stored-in-tpr-file" title="Permalink to this headline">¶</a></h2>
<p>Added a parameter ngroup to the pull coord parameters. This is now
also stored in the tpr file. This makes the pull geometry forward
compatible, which is useful since it avoid bumping the .tpr version
with every new geometry, and we expect that users want to experiment
with new geometries.</p>
</div>
<div class="section" id="added-pull-coordinate-geometry-angle-axis">
<h2>Added pull coordinate geometry angle-axis<a class="headerlink" href="#added-pull-coordinate-geometry-angle-axis" title="Permalink to this headline">¶</a></h2>
<p>The new geometry is described in the docs.
Some checks in readpull.cpp where reorganized since adding new
geometries made some old logic a bit convoluted.</p>
</div>
<div class="section" id="added-pull-coordinate-geometry-dihedral-angle">
<h2>Added pull coordinate geometry dihedral (angle)<a class="headerlink" href="#added-pull-coordinate-geometry-dihedral-angle" title="Permalink to this headline">¶</a></h2>
<p>How to use the new geometry is explained in the docs.</p>
</div>
<div class="section" id="added-pull-coordinate-geometry-angle">
<h2>Added pull coordinate geometry angle<a class="headerlink" href="#added-pull-coordinate-geometry-angle" title="Permalink to this headline">¶</a></h2>
<p>A new subsection was added to the docs explaining the new geometry.</p>
</div>
<div class="section" id="replaced-pull-print-com1-2-mdp-option-with-pull-print-com">
<h2>Replaced <code class="docutils literal"><span class="pre">pull-print-com1,2</span></code> mdp option with <code class="docutils literal"><span class="pre">pull-print-com</span></code><a class="headerlink" href="#replaced-pull-print-com1-2-mdp-option-with-pull-print-com" title="Permalink to this headline">¶</a></h2>
<p>Changes were made to the pull output order and naming.</p>
</div>
<div class="section" id="added-pull-potential-flat-bottom-high">
<h2>Added pull potential flat-bottom-high<a class="headerlink" href="#added-pull-potential-flat-bottom-high" title="Permalink to this headline">¶</a></h2>
<p>Added the new pull coordinate type flat-bottom-high, which is a flat
potential above the reference value and harmonic below.</p>
</div>
<div class="section" id="added-gmx-grompp-check-for-pull-group">
<h2>Added <code class="docutils literal"><span class="pre">gmx</span> <span class="pre">grompp</span></code> check for pull group<a class="headerlink" href="#added-gmx-grompp-check-for-pull-group" title="Permalink to this headline">¶</a></h2>
<p>Added a check for valid pull groups in a pull coordinate.
Using a pull group index that was out of range would cause invalid
memory access.</p>
</div>
<div class="section" id="added-new-swapping-functionality-to-computational-electrophysiology-module">
<h2>Added new swapping functionality to computational electrophysiology module<a class="headerlink" href="#added-new-swapping-functionality-to-computational-electrophysiology-module" title="Permalink to this headline">¶</a></h2>
<p>Support was added for ion/water position swapping for multiple ion
types and polyatomic ions, including use of a user-defined number of
ionic species, and (small) polyatomic ions.</p>
<p>Also added two extra .mdp file parameters ‘bulk-offset’ that allow the
user to specify an offset of the swap layers from the compartment
midplanes. This is useful for setups where e.g. a transmembrane
protein extends far into at least one of the compartments. Without an
offset, ions would be swapped in the vicinity of the protein, which is
not wanted. Adding an extended water layer comes at the cost of
performance, which is not the case for the offset solution.</p>
<p>Documentation and testing was improved.</p>
</div>
<div class="section" id="fixed-logic-for-dd-missing-interactions-check">
<h2>Fixed logic for DD missing-interactions check<a class="headerlink" href="#fixed-logic-for-dd-missing-interactions-check" title="Permalink to this headline">¶</a></h2>
<p>The code that was intended to double check that the domain decomposition
algorithm has not missed any interactions was inactive in several
cases, and has been fixed.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/1882">Issue 1882</a>, <a class="reference external" href="https://redmine.gromacs.org/issues/1793">Issue 1793</a></p>
</div>
<div class="section" id="permitted-forces-and-velocities-to-be-written-to-compressed-tng">
<h2>Permitted forces and velocities to be written to compressed TNG<a class="headerlink" href="#permitted-forces-and-velocities-to-be-written-to-compressed-tng" title="Permalink to this headline">¶</a></h2>
<p>If there is no uncompressed coordinate output, write forces
and velocities to the TNG file with compressed coordinate
output. If there is uncompressed coordinate output to a
TNG file, forces and velocities will be written to it.</p>
<p>Use a greatest common divisor to set the frequency of some TNG
data output to ensure lambdas and box shape are written at least
as often as anything else.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/1863">Issue 1863</a></p>
</div>
<div class="section" id="added-new-notes-to-the-user-when-coupling-algorithms-are-unavailable">
<h2>Added new notes to the user when coupling algorithms are unavailable<a class="headerlink" href="#added-new-notes-to-the-user-when-coupling-algorithms-are-unavailable" title="Permalink to this headline">¶</a></h2>
<p>mdrun will now give the user an explanatory note when pressure and/or
temperature coupling is turned off.</p>
</div>
<div class="section" id="added-mdrun-check-for-finite-energies">
<h2>Added mdrun check for finite energies<a class="headerlink" href="#added-mdrun-check-for-finite-energies" title="Permalink to this headline">¶</a></h2>
<p>Added a check that the total potential energy is finite. This check is
nearly free and can catch issues with incorrectly set up systems
before users get a confusing constraint or PME error. Note that this
check is only performed at steps where energies are calculated, so it
will often not catch an exploding system.</p>
</div>
<div class="section" id="added-gmx-grompp-check-for-unbound-atoms">
<h2>Added <code class="docutils literal"><span class="pre">gmx</span> <span class="pre">grompp</span></code> check for unbound atoms<a class="headerlink" href="#added-gmx-grompp-check-for-unbound-atoms" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">gmx</span> <span class="pre">grompp</span></code> now prints a note for atoms that are not connected by a
potential or constraint to any other atom in the same moleculetype,
since this often means the user made a mistake.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/1958">Issue 1958</a></p>
</div>
<div class="section" id="improved-multi-simulation-signalling">
<h2>Improved multi-simulation signalling<a class="headerlink" href="#improved-multi-simulation-signalling" title="Permalink to this headline">¶</a></h2>
<p>Multi-simulations (including REMD) may have need to send messages
between the simulations. For example, REMD needs to write a
fully-consistent set of checkpoint files so that the restart works
correctly, but normal multi-simulations are fine with decoupled
progress and will simulate more efficiently if they can do
so. Similarly, <code class="docutils literal"><span class="pre">gmx_mpi</span> <span class="pre">mdrun</span> <span class="pre">-maxh</span> <span class="pre">-multi</span></code> needs to synchronize
only for REMD. The implementation has been upgraded so that such
coupling happens only when an algorithm chosen by the user requires
it.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/860">Issue 860</a>, <a class="reference external" href="https://redmine.gromacs.org/issues/692">Issue 692</a>, <a class="reference external" href="https://redmine.gromacs.org/issues/1857">Issue 1857</a>, <a class="reference external" href="https://redmine.gromacs.org/issues/1942">Issue 1942</a></p>
<p>Changed multi-simulation nsteps behaviour
“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”“”-</p>
<p>It is unclear what the expected behaviour of a multi-simulation should
be if the user supplies any of the possible non-uniform distributions
of init_step and nsteps, sourced from any of .mdp, .cpt or command
line. Previously mdrun adjusted the total number of stesps to run so
that each run did the same number of steps, but now it reports on the
non-uniformity and proceed, assuming the user knows what they are
doing.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/1857">Issue 1857</a></p>
</div>
<div class="section" id="added-working-directory-to-things-reported-in-log-file">
<h2>Added working directory to things reported in .log file<a class="headerlink" href="#added-working-directory-to-things-reported-in-log-file" title="Permalink to this headline">¶</a></h2>
<p>When running GROMACS via a batch script, it is useful to know which
working directory is being used for relative paths (file names) in the
command line. This is now written alongside other header information.</p>
</div>
<div class="section" id="prevented-fragile-use-cases-involving-checkpoint-restarts-and-or-appending">
<h2>Prevented fragile use cases involving checkpoint restarts and/or appending<a class="headerlink" href="#prevented-fragile-use-cases-involving-checkpoint-restarts-and-or-appending" title="Permalink to this headline">¶</a></h2>
<p>All output files named in the checkpoint file (ie. that were
used in the previous run) must be present before a checkpoint
restart will be permitted. Thus,
workflows where people used things like
<code class="docutils literal"><span class="pre">gmx</span> <span class="pre">mdrun</span> <span class="pre">-s</span> <span class="pre">production</span> <span class="pre">-cpi</span> <span class="pre">equilibration</span></code>
are no longer available to do a “continuous” restart. Instead, use
<code class="docutils literal"><span class="pre">gmx</span> <span class="pre">grompp</span> <span class="pre">-t</span> <span class="pre">equilibration</span> <span class="pre">-o</span> <span class="pre">production</span></code>.</p>
<p><a class="reference external" href="https://redmine.gromacs.org/issues/1777">Issue 1777</a></p>
</div>
<div class="section" id="removed-warning-after-openmp-core-count-check">
<h2>Removed warning after OpenMP core-count check<a class="headerlink" href="#removed-warning-after-openmp-core-count-check" title="Permalink to this headline">¶</a></h2>
<p>In many cases <code class="docutils literal"><span class="pre">gmx_mpi</span> <span class="pre">mdrun</span></code> issued a warning that compared the total
core count with something different returned from OpenMP. This problem
is caused by inappropriate management of thread affinity masks, but
the wording of the message did not help the user realise this, so has
been removed. <code class="docutils literal"><span class="pre">gmx_mpi</span> <span class="pre">mdrun</span> <span class="pre">-pin</span> <span class="pre">on</span></code> may help improve performance in
such cases.</p>
</div>
<div class="section" id="preparation-for-hardware-detection-might-try-to-force-offline-cores-to-work">
<h2>Preparation for hardware detection might try to force offline cores to work<a class="headerlink" href="#preparation-for-hardware-detection-might-try-to-force-offline-cores-to-work" title="Permalink to this headline">¶</a></h2>
<p>Hardware detection might be foiled by kernels that take cores offline
when work is unavailable. We are not aware of any such platforms on which
GROMACS is likely to be used, but we will probably start to see them
soon. On such platforms, if the number of cores physically present
differs from the count that are online, we try to force them online
before deciding how GROMACS will use the online cores. For now, no x86 or
PowerPC platforms need such code, so it will never run on those platforms.
The good news is that we no longer have to risk making a confusing warning
about such possibilities.</p>
</div>
<div class="section" id="added-new-suggestion-for-users-to-try-e-g-hyper-threading-if-its-disabled">
<h2>Added new suggestion for users to try e.g. hyper-threading, if its disabled<a class="headerlink" href="#added-new-suggestion-for-users-to-try-e-g-hyper-threading-if-its-disabled" title="Permalink to this headline">¶</a></h2>
<p>GROMACS tends to perform best with several hardware threads available
per core (e.g. hyper-threading turned on, on x86), and now the log file
will note explicitly when such opportunities exist.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">New and improved features</a><ul>
<li><a class="reference internal" href="#changed-to-require-a-c-11-compiler">Changed to require a C++11 compiler</a></li>
<li><a class="reference internal" href="#changed-to-support-only-cuda-5-0-and-more-recent-versions">Changed to support only CUDA 5.0 and more recent versions</a></li>
<li><a class="reference internal" href="#allowed-rcoulomb-rvdw-with-pme">Allowed rcoulomb &gt; rvdw with PME</a></li>
<li><a class="reference internal" href="#added-optional-support-for-portable-hardware-locality-hwloc">Added optional support for portable hardware locality (hwloc)</a></li>
<li><a class="reference internal" href="#made-normal-mode-calculations-work-with-shells-and-vsites">Made normal-mode calculations work with shells and vsites</a></li>
<li><a class="reference internal" href="#changed-pull-group-count-for-coords-stored-in-tpr-file">Changed pull group count for coords stored in tpr file</a></li>
<li><a class="reference internal" href="#added-pull-coordinate-geometry-angle-axis">Added pull coordinate geometry angle-axis</a></li>
<li><a class="reference internal" href="#added-pull-coordinate-geometry-dihedral-angle">Added pull coordinate geometry dihedral (angle)</a></li>
<li><a class="reference internal" href="#added-pull-coordinate-geometry-angle">Added pull coordinate geometry angle</a></li>
<li><a class="reference internal" href="#replaced-pull-print-com1-2-mdp-option-with-pull-print-com">Replaced <code class="docutils literal"><span class="pre">pull-print-com1,2</span></code> mdp option with <code class="docutils literal"><span class="pre">pull-print-com</span></code></a></li>
<li><a class="reference internal" href="#added-pull-potential-flat-bottom-high">Added pull potential flat-bottom-high</a></li>
<li><a class="reference internal" href="#added-gmx-grompp-check-for-pull-group">Added <code class="docutils literal"><span class="pre">gmx</span> <span class="pre">grompp</span></code> check for pull group</a></li>
<li><a class="reference internal" href="#added-new-swapping-functionality-to-computational-electrophysiology-module">Added new swapping functionality to computational electrophysiology module</a></li>
<li><a class="reference internal" href="#fixed-logic-for-dd-missing-interactions-check">Fixed logic for DD missing-interactions check</a></li>
<li><a class="reference internal" href="#permitted-forces-and-velocities-to-be-written-to-compressed-tng">Permitted forces and velocities to be written to compressed TNG</a></li>
<li><a class="reference internal" href="#added-new-notes-to-the-user-when-coupling-algorithms-are-unavailable">Added new notes to the user when coupling algorithms are unavailable</a></li>
<li><a class="reference internal" href="#added-mdrun-check-for-finite-energies">Added mdrun check for finite energies</a></li>
<li><a class="reference internal" href="#added-gmx-grompp-check-for-unbound-atoms">Added <code class="docutils literal"><span class="pre">gmx</span> <span class="pre">grompp</span></code> check for unbound atoms</a></li>
<li><a class="reference internal" href="#improved-multi-simulation-signalling">Improved multi-simulation signalling</a></li>
<li><a class="reference internal" href="#added-working-directory-to-things-reported-in-log-file">Added working directory to things reported in .log file</a></li>
<li><a class="reference internal" href="#prevented-fragile-use-cases-involving-checkpoint-restarts-and-or-appending">Prevented fragile use cases involving checkpoint restarts and/or appending</a></li>
<li><a class="reference internal" href="#removed-warning-after-openmp-core-count-check">Removed warning after OpenMP core-count check</a></li>
<li><a class="reference internal" href="#preparation-for-hardware-detection-might-try-to-force-offline-cores-to-work">Preparation for hardware detection might try to force offline cores to work</a></li>
<li><a class="reference internal" href="#added-new-suggestion-for-users-to-try-e-g-hyper-threading-if-its-disabled">Added new suggestion for users to try e.g. hyper-threading, if its disabled</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="highlights.html"
                        title="previous chapter">Highlights</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="performance.html"
                        title="next chapter">Performance improvements</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/release-notes/2016/major/new-features.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="performance.html" title="Performance improvements"
             >next</a> |</li>
        <li class="right" >
          <a href="highlights.html" title="Highlights"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">GROMACS 2018.3</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Release notes</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, GROMACS development team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.1.
    </div>
  </body>
</html>