
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Common errors when using GROMACS &#8212; GROMACS 2018.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2018.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="File formats" href="file-formats.html" />
    <link rel="prev" title="Getting good performance from mdrun" href="mdrun-performance.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="file-formats.html" title="File formats"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mdrun-performance.html" title="Getting good performance from mdrun"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">GROMACS 2018.3</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">User guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="common-errors-when-using-gromacs">
<h1>Common errors when using GROMACS<a class="headerlink" href="#common-errors-when-using-gromacs" title="Permalink to this headline">¶</a></h1>
<p>The vast majority of error messages generated by GROMACS are descriptive,
informing the user where the exact error lies. Some errors that arise are noted
below, along with more details on what the issue is and how to solve it.</p>
<div class="section" id="common-errors-during-usage">
<span id="common-errors"></span><h2>Common errors during usage<a class="headerlink" href="#common-errors-during-usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="out-of-memory-when-allocating">
<span id="out-of-memory"></span><h3>Out of memory when allocating<a class="headerlink" href="#out-of-memory-when-allocating" title="Permalink to this headline">¶</a></h3>
<p>The program has attempted to assign memory to be used in the calculation, but is unable to due to insufficient memory.</p>
<p>Possible solutions are:</p>
<ul class="simple">
<li>reduce the scope of the number of atoms selected for analysis.</li>
<li>reduce the length of trajectory file being processed.</li>
<li>in some cases confusion between Ångström and nm may lead to users wanting to generate a
<a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> water box that is 10<sup>3</sup> times larger than what they think it is (e.g. <a class="reference internal" href="../onlinehelp/gmx-solvate.html#gmx-solvate"><span class="std std-ref">gmx solvate</span></a>).</li>
<li>use a computer with more memory.</li>
<li>install more memory in the computer.</li>
</ul>
<p>The user should bear in mind that the cost in time and/or memory for various activities will
scale with the number of atoms/groups/residues <em>N</em> or the simulation length <em>T</em> as order N,
NlogN, or N<sup>2</sup> (or maybe worse!) and the same for <em>T</em>, depending on the type of activity.
If it takes a long time, have a think about what you are doing, and the underlying algorithm
(see the <a class="reference external" href="../manual-2018.3.pdf">Reference manual</a>, man page, or use the -h flag for the utility), and
see if there’s something sensible you can do that has better scaling properties.</p>
</div>
</div>
<div class="section" id="errors-in-pdb2gmx">
<span id="pdb2gmx-errors"></span><h2>Errors in <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a><a class="headerlink" href="#errors-in-pdb2gmx" title="Permalink to this headline">¶</a></h2>
<div class="section" id="residue-xxx-not-found-in-residue-topology-database">
<h3>Residue ‘XXX’ not found in residue topology database<a class="headerlink" href="#residue-xxx-not-found-in-residue-topology-database" title="Permalink to this headline">¶</a></h3>
<p>This means that the force field you have selected while running <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> does not have an entry in
the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">residue database</span></a> for XXX. The <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">residue database</span></a> entry is necessary both for stand-alone
molecules (e.g. formaldehyde) or a peptide (standard or non-standard). This entry defines the atom
types, connectivity, bonded and non-bonded interaction types for the residue and is necessary
to use <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> to build a <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file. A <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">residue database</span></a>
entry may be missing simply because the
database does not contain the residue at all, or because the name is different.</p>
<p>For new users, this error appears because they are running <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> on a
<a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">PDB</span></a> file they have, without consideration of the contents of the file. A <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a>
is not magical, it can only deal with molecules or residues (building blocks) that are
provided in the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">residue database</span></a> or included otherwise.</p>
<p>If you want to use <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> to automatically generate your topology, you have
to ensure that the appropriate <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> entry is present within the desired <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> and
has the same name as the building block you are trying to use. If you call your
molecule “HIS,” then <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> will try to build histidine, based on the
<code class="docutils literal"><span class="pre">[</span> <span class="pre">HIS</span> <span class="pre">]</span></code> entry in the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> file, so it will look for the exact atomic entries for histidine, no more no less.</p>
<p>If you want a <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> for an arbitrary molecule, you cannot use <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> (unless you
build the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> entry yourself). You will have to build that entry by hand, or use another program
(such as <a class="reference internal" href="../onlinehelp/gmx-x2top.html#gmx-x2top"><span class="std std-ref">x2top</span></a> or one of the scripts contributed by users) to build the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file.</p>
<p>If there is not an entry for this residue in the database, then
the options for obtaining the force field parameters are:</p>
<ul class="simple">
<li>see if there is a different name being used for the residue
in the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">residue database</span></a> and rename as appropriate,</li>
<li>parameterize the residue / molecule yourself (lots of work, even for an expert),</li>
<li>find a <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology file</span></a> for the molecule, convert it to an
<a class="reference internal" href="file-formats.html#itp"><span class="std std-ref">itp</span></a> file and include it in your <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file,</li>
<li>use another <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> which has parameters available for this,</li>
<li>search the primary literature for publications for parameters for the
residue that are consistent with the force field that is being used.</li>
</ul>
</div>
<div class="section" id="long-bonds-and-or-missing-atoms">
<h3>Long bonds and/or missing atoms<a class="headerlink" href="#long-bonds-and-or-missing-atoms" title="Permalink to this headline">¶</a></h3>
<p>There are probably atoms missing earlier in the <a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">pdb</span></a> file which makes <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> go crazy.
Check the screen output of <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a>, as it will tell you which one is missing. Then add
the atoms in your <a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">pdb</span></a> file, energy minimization will put them in the right place, or
fix the side chain with e.g. the <a class="reference external" href="http://swift.cmbi.ru.nl/whatif/">WHAT IF</a> program.</p>
</div>
<div class="section" id="chain-identifier-x-was-used-in-two-non-sequential-blocks">
<h3>Chain identifier ‘X’ was used in two non-sequential blocks<a class="headerlink" href="#chain-identifier-x-was-used-in-two-non-sequential-blocks" title="Permalink to this headline">¶</a></h3>
<p>This means that within the <a class="reference internal" href="file-formats.html#gmx-structure-files"><span class="std std-ref">coordinate file</span></a> fed to <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a>, the X
chain has been split, possibly by the incorrect insertion of one molecule within another.
The solution is simple: move the inserted molecule to a location within the file so that it is not splitting another molecule.
This message may also mean that the same chain identifier has been used for two
separate chains. In that case, rename the second chain to a unique identifier.</p>
</div>
<div class="section" id="warning-atom-x-is-missing-in-residue-xxx-y-in-the-pdb-file">
<span id="gmx-atom-missing"></span><h3>WARNING: atom X is missing in residue XXX Y in the pdb file<a class="headerlink" href="#warning-atom-x-is-missing-in-residue-xxx-y-in-the-pdb-file" title="Permalink to this headline">¶</a></h3>
<p>Related to the long bonds/missing atoms error above, this error is usually quite
obvious in its meaning. That is, <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> expects certain atoms within
the given residue, based on the entries in the force field <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> file.
There are several cases to which this error applies:</p>
<ul class="simple">
<li>Missing hydrogen atoms; the error message may be suggesting that an entry in the <a class="reference internal" href="file-formats.html#hdb"><span class="std std-ref">hdb</span></a>
file is missing.  More likely, the nomenclature of your hydrogen atoms simply does not match
what is expected by the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> entry.  In this case, use <code class="docutils literal"><span class="pre">-ignh</span></code> to
allow <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> to add the correct hydrogens for you,
or re-name the problematic atoms.</li>
<li>A terminal residue (usually the N-terminus) is missing H atoms; this usually suggests
that the proper <code class="docutils literal"><span class="pre">-ter</span></code> option has not been supplied or chosen properly. In the case of
the <a class="reference internal" href="force-fields.html#gmx-amber-ff"><span class="std std-ref">AMBER force fields</span></a>, nomenclature is typically the problem.
N-terminal and C-terminal residues must be prefixed by N and C, respectively.
For example, an N-terminal alanine should not be listed in the <a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">pdb</span></a> file
as <code class="docutils literal"><span class="pre">ALA</span></code>, but rather <code class="docutils literal"><span class="pre">NALA</span></code>, as specified in the
<a class="reference external" href="http://ffamber.cnsm.csulb.edu/ffamber.php">ffamber</a> instructions.</li>
<li>Atoms are simply missing in the structure file provided to <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a>;
look for <code class="docutils literal"><span class="pre">REMARK</span> <span class="pre">465</span></code> and <code class="docutils literal"><span class="pre">REMARK</span> <span class="pre">470</span></code> entries in the <a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">pdb</span></a> file. These atoms
will have to be modeled in using external software. There is no
GROMACS tool to re-construct incomplete models.</li>
</ul>
<p>Contrary to what the error message says, the use of the option <code class="docutils literal"><span class="pre">-missing</span></code>
is almost always inappropriate.  The <code class="docutils literal"><span class="pre">-missing</span></code> option should only be used to
generate specialized topologies for amino acid-like molecules to take
advantage of <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> entries.  If you find yourself using <code class="docutils literal"><span class="pre">-missing</span></code>
in order to generate a topology for a protein or nucleic acid,
don’t; the topology produced is likely physically unrealistic.</p>
</div>
<div class="section" id="atom-x-in-residue-yyy-not-found-in-rtp-entry">
<h3>Atom X in residue YYY not found in rtp entry<a class="headerlink" href="#atom-x-in-residue-yyy-not-found-in-rtp-entry" title="Permalink to this headline">¶</a></h3>
<p>If you are attempting to assemble a topology using <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a>, the atom names
are expected to match those found in the <a class="reference internal" href="file-formats.html#rtp"><span class="std std-ref">rtp</span></a> file that define the building
block(s) in your structure.  In most cases, the problem arises from a naming mismatch,
so simply re-name the atoms in your <a class="reference internal" href="file-formats.html#gmx-structure-files"><span class="std std-ref">coordinate file</span></a> appropriately.
In other cases, you may be supplying a structure that has residues that do not conform
to the expectations of the <cite>force field &lt;gmx-force-field&gt;</cite>, in which case you should
investigate why such a difference is occurring and make a decision based on what you
find - use a different <cite>force field &lt;gmx-force-field&gt;</cite>, manually edit the structure, etc.</p>
</div>
<div class="section" id="no-force-fields-found-files-with-name-forcefield-itp-in-subdirectories-ending-on-ff">
<h3>No force fields found (files with name ‘forcefield.itp’ in subdirectories ending on ‘.ff’)<a class="headerlink" href="#no-force-fields-found-files-with-name-forcefield-itp-in-subdirectories-ending-on-ff" title="Permalink to this headline">¶</a></h3>
<p>This means your environment is not configured to use GROMACS properly, because
<a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> cannot find its databases of forcefield information. This could
happen because a GROMACS installation was moved from one location to another.
Either follow the instructions about
<a class="reference internal" href="../install-guide/index.html#getting-access-to-gromacs"><span class="std std-ref">getting access to |Gromacs| after installation</span></a>
or re-install GROMACS before doing so.</p>
</div>
</div>
<div class="section" id="errors-in-grompp">
<h2>Errors in <a class="reference internal" href="../onlinehelp/gmx-grompp.html#gmx-grompp"><span class="std std-ref">grompp</span></a><a class="headerlink" href="#errors-in-grompp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="found-a-second-defaults-directive-file">
<h3>Found a second defaults directive file<a class="headerlink" href="#found-a-second-defaults-directive-file" title="Permalink to this headline">¶</a></h3>
<p>This is caused by the <code class="docutils literal"><span class="pre">[defaults]</span></code> directive appearing more than once in the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> or
<a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> files for the system - it can only appear once. A typical cause of
this is a second defaults being set in an included <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> file, <a class="reference internal" href="file-formats.html#itp"><span class="std std-ref">itp</span></a>, that
has been sourced from somewhere else. For specifications on how the topology files work,
see the <a class="reference external" href="../manual-2018.3.pdf">reference manual</a>, Section 5.6.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">defaults</span> <span class="p">]</span>
<span class="p">;</span> <span class="n">nbfunc</span> <span class="n">comb</span><span class="o">-</span><span class="n">rule</span> <span class="n">gen</span><span class="o">-</span><span class="n">pairs</span> <span class="n">fudgeLJ</span> <span class="n">fudgeQQ</span>
<span class="mi">1</span>       <span class="mi">1</span>       <span class="n">no</span>       <span class="mf">1.0</span>       <span class="mf">1.0</span>
</pre></div>
</div>
<p>One solution is to simply comment out (or delete) the lines of code out in the file where it is included for the second time i.e.,:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">;[</span> <span class="n">defaults</span> <span class="p">]</span>
<span class="p">;</span> <span class="n">nbfunc</span> <span class="n">comb</span><span class="o">-</span><span class="n">rule</span> <span class="n">gen</span><span class="o">-</span><span class="n">pairs</span> <span class="n">fudgeLJ</span> <span class="n">fudgeQQ</span>
<span class="p">;</span><span class="mi">1</span>       <span class="mi">1</span>       <span class="n">no</span>       <span class="mf">1.0</span>       <span class="mf">1.0</span>
</pre></div>
</div>
<p>A better approach to finding a solution is to re-think what you are doing. The <code class="docutils literal"><span class="pre">[defaults]</span></code>
directive should only be appearing at the top of your <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file
where you choose the <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a>. If you are trying
to mix two <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force fields</span></a>, then you are asking for trouble.
If a molecule <a class="reference internal" href="file-formats.html#itp"><span class="std std-ref">itp</span></a> file tries to choose a force field, then whoever produced it is asking for trouble.</p>
</div>
<div class="section" id="invalid-order-for-directive-xxx">
<h3>Invalid order for directive xxx<a class="headerlink" href="#invalid-order-for-directive-xxx" title="Permalink to this headline">¶</a></h3>
<p>The directives in the .top and .itp files have rules about the order in which they can
appear, and this error is seen when the order is violated. Consider the examples and
discussion in chapter 5 of the <a class="reference external" href="../manual-2018.3.pdf">reference manual</a>, and/or from tutorial material.
The <a class="reference internal" href="getting-started.html#gmx-topo-include"><span class="std std-ref">include file mechanism</span></a> cannot be used to <code class="docutils literal"><span class="pre">#include</span></code> a
file in just any old location, because they contain directives and these have to be properly placed.</p>
<p>In particular, <code class="docutils literal"><span class="pre">Invalid</span> <span class="pre">order</span> <span class="pre">for</span> <span class="pre">directive</span> <span class="pre">defaults</span></code> is a result of defaults being
set in the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> or <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> files in the inappropriate location;
the <code class="docutils literal"><span class="pre">[defaults]</span></code> section can only appear once and must be the first directive in
the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a>.  The <code class="docutils literal"><span class="pre">[defaults]</span></code> directive is typically present in the <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a>
file (forcefield.itp), and is added to the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> when you <code class="docutils literal"><span class="pre">#include</span></code> this file in the system topology.</p>
<p>If the directive in question is <code class="docutils literal"><span class="pre">[atomtypes]</span></code> (which is the most common source of this error) or
any other bonded or nonbonded <code class="docutils literal"><span class="pre">[*types]</span></code> directive, typically the user is adding some
non-standard species (ligand, solvent, etc) that introduces new atom types or parameters
into the system. As indicated above, these new types and parameters must appear before
any <code class="docutils literal"><span class="pre">[moleculetype]</span></code> directive. The <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> has to be
fully constructed before any molecules can be defined.</p>
</div>
<div class="section" id="atom-index-n-in-position-restraints-out-of-bounds">
<h3>Atom index n in position_restraints out of bounds<a class="headerlink" href="#atom-index-n-in-position-restraints-out-of-bounds" title="Permalink to this headline">¶</a></h3>
<p>A common problem is placing position restraint files for multiple molecules out of order.
Recall that a position restraint <a class="reference internal" href="file-formats.html#itp"><span class="std std-ref">itp</span></a> file containing a <code class="docutils literal"><span class="pre">[</span> <span class="pre">position_restraints</span> <span class="pre">]</span></code>
block can only belong to the <code class="docutils literal"><span class="pre">[</span> <span class="pre">moleculetype</span> <span class="pre">]</span></code> block that contains it. For example:</p>
<p>WRONG:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#include &quot;topol_A.itp&quot;</span>
<span class="c1">#include &quot;topol_B.itp&quot;</span>
<span class="c1">#include &quot;ligand.itp&quot;</span>

<span class="c1">#ifdef POSRES</span>
<span class="c1">#include &quot;posre_A.itp&quot;</span>
<span class="c1">#include &quot;posre_B.itp&quot;</span>
<span class="c1">#include &quot;ligand_posre.itp&quot;</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>RIGHT:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#include &quot;topol_A.itp&quot;</span>
<span class="c1">#ifdef POSRES</span>
<span class="c1">#include &quot;posre_A.itp&quot;</span>
<span class="c1">#endif</span>

<span class="c1">#include &quot;topol_B.itp&quot;</span>
<span class="c1">#ifdef POSRES</span>
<span class="c1">#include &quot;posre_B.itp&quot;</span>
<span class="c1">#endif</span>

<span class="c1">#include &quot;ligand.itp&quot;</span>
<span class="c1">#ifdef POSRES</span>
<span class="c1">#include &quot;ligand_posre.itp&quot;</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>Further, the atom index of each <code class="docutils literal"><span class="pre">[position_restraint]</span></code> must be relative to the
<code class="docutils literal"><span class="pre">[moleculetype]</span></code>, not relative to the system (because the parsing has not reached
<code class="docutils literal"><span class="pre">[molecules]</span></code> yet, there is no such concept as “system”). So you cannot use the output
of a tool like <a class="reference internal" href="../onlinehelp/gmx-genrestr.html#gmx-genrestr"><span class="std std-ref">genrestr</span></a> blindly (as <code class="docutils literal"><span class="pre">genrestr</span> <span class="pre">-h</span></code> warns).</p>
</div>
<div class="section" id="system-has-non-zero-total-charge">
<h3>System has non-zero total charge<a class="headerlink" href="#system-has-non-zero-total-charge" title="Permalink to this headline">¶</a></h3>
<p>Notifies you that counter-ions may be required for the system to neutralize the charge or
there may be problems with the topology.</p>
<p>If the charge is not very close to an integer, then this indicates that there is a problem with the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a>.
If <a class="reference internal" href="../onlinehelp/gmx-pdb2gmx.html#gmx-pdb2gmx"><span class="std std-ref">pdb2gmx</span></a> has been used, then look at the right-hand
comment column of the atom listing, which lists
the cumulative charge. This should be an integer after every residue (and/or charge group where
applicable). This will assist in finding the residue where things start departing from
integer values. Also check the terminal capping groups that have been used.</p>
<p>If the charge is already close to an integer, then the difference is caused by
<a class="reference internal" href="floating-point.html#gmx-floating-point"><span class="std std-ref">rounding errors</span></a> and not a major problem.</p>
<p>Note for PME users: It is possible to use a uniform neutralizing background
charge in PME to compensate for a system with a net background charge.
This may however, especially for non-homogeneous systems, lead to unwanted artifacts, as
shown in <cite>Hub, J. S., de Groot, B. L., Grubmüller, H. &amp; Groenhof, G. Quantifying
artifacts in Ewald simulations of inhomogeneous systems with a net charge.
*J. Chem. Theory Comput.* **10**, 381–390 (2014) &lt;http://pubs.acs.org/doi/abs/10.1021/ct400626b&gt;</cite>.
Nevertheless, it is a standard
practice to actually add counter-ions to make the system net neutral.</p>
</div>
<div class="section" id="incorrect-number-of-parameters">
<h3>Incorrect number of parameters<a class="headerlink" href="#incorrect-number-of-parameters" title="Permalink to this headline">¶</a></h3>
<p>Look at the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> file for the system. You’ve not given enough parameters for one of the
bonded definitions.  Sometimes this also occurs if you’ve mangled the <a class="reference internal" href="getting-started.html#gmx-topo-include"><span class="std std-ref">Include File Mechanism</span></a>
or the topology file format (see: <a class="reference external" href="../manual-2018.3.pdf">reference manual</a> Chapter 5) when you edited the file.</p>
</div>
<div class="section" id="number-of-coordinates-in-coordinate-file-does-not-match-topology">
<h3>Number of coordinates in coordinate file does not match topology<a class="headerlink" href="#number-of-coordinates-in-coordinate-file-does-not-match-topology" title="Permalink to this headline">¶</a></h3>
<p>This is pointing out that, based on the information provided in the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> file, <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a>,
the total number of atoms or particles within the system does not match exactly with what
is provided within the <a class="reference internal" href="file-formats.html#gmx-structure-files"><span class="std std-ref">coordinate file</span></a>, often a <a class="reference internal" href="file-formats.html#gro"><span class="std std-ref">gro</span></a> or a <a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">pdb</span></a>.</p>
<p>The most common reason for this is simply that the user has failed to update the topology file
after solvating or adding additional molecules to the system, or made a typographical error in
the number of one of the molecules within the system. Ensure that the end of the topology file
being used contains something like the following, that matches exactly with what is within the
coordinate file being used, in terms of both numbers and order of the molecules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">molecules</span> <span class="p">]</span>
<span class="p">;</span> <span class="n">Compound</span>   <span class="c1">#mol</span>
<span class="n">Protein</span>      <span class="mi">1</span>
<span class="n">SOL</span>          <span class="mi">10189</span>
<span class="n">NA</span><span class="o">+</span>          <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="section" id="fatal-error-no-such-moleculetype-xxx">
<h3>Fatal error: No such moleculetype XXX<a class="headerlink" href="#fatal-error-no-such-moleculetype-xxx" title="Permalink to this headline">¶</a></h3>
<p>Each type of molecule in your <code class="docutils literal"><span class="pre">[</span> <span class="pre">molecules</span> <span class="pre">]</span></code> section of your <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file must have a
corresponding <code class="docutils literal"><span class="pre">[</span> <span class="pre">moleculetype</span> <span class="pre">]</span></code> section defined previously, either in the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file or
an <a class="reference internal" href="getting-started.html#gmx-topo-include"><span class="std std-ref">included</span></a> <a class="reference internal" href="file-formats.html#itp"><span class="std std-ref">itp</span></a> file. See the <a class="reference external" href="../manual-2018.3.pdf">reference manual</a> section 5.6.1
for the syntax description. Your <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file doesn’t have such a definition for the
indicated molecule. Check the contents of the relevant files, how you have named your
molecules, and how you have tried to refer to them later. Pay attention to the status
of <code class="docutils literal"><span class="pre">#ifdef</span></code> and / or <code class="docutils literal"><span class="pre">#include</span></code> statements.</p>
</div>
<div class="section" id="t-coupling-group-xxx-has-fewer-than-10-of-the-atoms">
<h3>T-Coupling group XXX has fewer than 10% of the atoms<a class="headerlink" href="#t-coupling-group-xxx-has-fewer-than-10-of-the-atoms" title="Permalink to this headline">¶</a></h3>
<p>It is possible to specify separate <a class="reference internal" href="terminology.html#gmx-thermostats"><span class="std std-ref">thermostats</span></a> (temperature coupling groups)
for every molecule type within a simulation. This is a particularly bad practice employed by
many new users to molecular dynamics simulations.  Doing so is a bad idea, as you can
introduce errors and artifacts that are hard to predict. In some cases it is best to have all
molecules within a single group, using the default <code class="docutils literal"><span class="pre">System</span></code> group. If separate coupling groups are required to avoid
the <code class="docutils literal"><span class="pre">hot-solvent,</span> <span class="pre">cold-solute</span></code> problem, then ensure that they are of <code class="docutils literal"><span class="pre">sufficient</span> <span class="pre">size</span></code> and
combine molecule types that appear together within the simulation. For example, for
a protein in water with counter-ions, one would likely want to use <code class="docutils literal"><span class="pre">Protein</span></code> and <code class="docutils literal"><span class="pre">Non-Protein</span></code>.</p>
</div>
<div class="section" id="the-cut-off-length-is-longer-than-half-the-shortest-box-vector-or-longer-than-the-smallest-box-diagonal-element-increase-the-box-size-or-decrease-rlist">
<h3>The cut-off length is longer than half the shortest box vector or longer than the smallest box diagonal element. Increase the box size or decrease rlist<a class="headerlink" href="#the-cut-off-length-is-longer-than-half-the-shortest-box-vector-or-longer-than-the-smallest-box-diagonal-element-increase-the-box-size-or-decrease-rlist" title="Permalink to this headline">¶</a></h3>
<p>This error is generated in the cases as noted within the message. The dimensions of the box are such that an atom will
interact with itself (when using periodic boundary conditions), thus violating the minimum image convention.
Such an event is totally unrealistic and will introduce some serious artefacts. The solution is again what is
noted within the message, either increase the size of the simulation box so that it is at an absolute minimum
twice the cut-off length in all three dimensions (take care here if are using pressure coupling,
as the box dimensions will change over time and if they decrease even slightly, you will still be
violating the minimum image convention) or decrease the cut-off length (depending on the
<a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> utilised, this may not be an option).</p>
</div>
<div class="section" id="atom-index-1-in-bonds-out-of-bounds">
<h3>Atom index (1) in bonds out of bounds<a class="headerlink" href="#atom-index-1-in-bonds-out-of-bounds" title="Permalink to this headline">¶</a></h3>
<p>This kind of error looks like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Fatal</span> <span class="n">error</span><span class="p">:</span>
<span class="p">[</span> <span class="n">file</span> <span class="n">spc</span><span class="o">.</span><span class="n">itp</span><span class="p">,</span> <span class="n">line</span> <span class="mi">32</span> <span class="p">]</span>
<span class="n">Atom</span> <span class="n">index</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">bonds</span> <span class="n">out</span> <span class="n">of</span> <span class="n">bounds</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span>
<span class="n">This</span> <span class="n">probably</span> <span class="n">means</span> <span class="n">that</span> <span class="n">you</span> <span class="n">have</span> <span class="n">inserted</span> <span class="n">topology</span>
<span class="n">section</span> <span class="s2">&quot;settles&quot;</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">part</span> <span class="n">belonging</span> <span class="n">to</span> <span class="n">a</span> <span class="n">different</span>
<span class="n">molecule</span> <span class="n">than</span> <span class="n">you</span> <span class="n">intended</span> <span class="n">to</span><span class="o">.</span> <span class="ow">in</span> <span class="n">that</span> <span class="n">case</span> <span class="n">move</span> <span class="n">the</span>
<span class="s2">&quot;settles&quot;</span> <span class="n">section</span> <span class="n">to</span> <span class="n">the</span> <span class="n">right</span> <span class="n">molecule</span><span class="o">.</span>
</pre></div>
</div>
<p>This error is fairly self-explanatory. You should look at your <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">top</span></a> file and check that all
of the <code class="docutils literal"><span class="pre">[molecules]</span></code> sections contain all of the data pertaining to that molecule, and no
other data. That is, you cannot <code class="docutils literal"><span class="pre">#include</span></code> another molecule type (<a class="reference internal" href="file-formats.html#itp"><span class="std std-ref">itp</span></a> file) before
the previous <code class="docutils literal"><span class="pre">[moleculetype]</span></code> has ended. Consult the examples in chapter 5 of the <a class="reference external" href="../manual-2018.3.pdf">reference manual</a>
for information on the required ordering of the different <code class="docutils literal"><span class="pre">[sections]</span></code>. Pay attention to
the contents of any files you have <a class="reference internal" href="getting-started.html#gmx-topo-include"><span class="std std-ref">included</span></a> with <code class="docutils literal"><span class="pre">#include</span></code> directives.</p>
<p>This error can also arise if you are using a water model that is not enabled for use with your
chosen <a class="reference internal" href="terminology.html#gmx-force-field"><span class="std std-ref">force field</span></a> by default. For example, if you are attempting to use
the SPC water model with an <a class="reference internal" href="force-fields.html#gmx-amber-ff"><span class="std std-ref">AMBER force field</span></a>, you will see this error.
The reason is that, in <code class="docutils literal"><span class="pre">spc.itp</span></code>, there is no <code class="docutils literal"><span class="pre">#ifdef</span></code> statement defining atom types for any
of the <a class="reference internal" href="force-fields.html#gmx-amber-ff"><span class="std std-ref">AMBER force fields</span></a>. You can either add this section yourself, or use a different water model.</p>
</div>
<div class="section" id="xxx-non-matching-atom-names">
<h3>XXX non-matching atom names<a class="headerlink" href="#xxx-non-matching-atom-names" title="Permalink to this headline">¶</a></h3>
<p>This error usually indicates that the order of the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a> file does not match that
of the <a class="reference internal" href="file-formats.html#gmx-structure-files"><span class="std std-ref">coordinate file</span></a>.  When running <a class="reference internal" href="../onlinehelp/gmx-grompp.html#gmx-grompp"><span class="std std-ref">grompp</span></a>, the
program reads through the <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a>, mapping the supplied parameters to the atoms in
the <a class="reference internal" href="file-formats.html#gmx-structure-files"><span class="std std-ref">coordinate</span></a> file.  If there is a mismatch, this error is generated.
To remedy the problem, make sure that the contents of your <code class="docutils literal"><span class="pre">[</span> <span class="pre">molecules</span> <span class="pre">]</span></code> directive
matches the exact order of the atoms in the coordinate file.</p>
<p>In some cases, the error is harmless. For example, when running simulations with the
<a class="reference external" href="http://cgmartini.nl/">MARTINI force field</a>, the workflow relies on <a class="reference internal" href="../onlinehelp/gmx-grompp.html#gmx-grompp"><span class="std std-ref">grompp</span></a> to apply the
correct names, which are not previously assigned.  Also, perhaps you are using a
<a class="reference internal" href="file-formats.html#gmx-structure-files"><span class="std std-ref">coordinate</span></a> file that has the old (pre-4.5) ion nomenclature.
In this case, allowing <a class="reference internal" href="../onlinehelp/gmx-grompp.html#gmx-grompp"><span class="std std-ref">grompp</span></a> to re-assign names is harmless.
For just about any other situation, when this error comes up, <strong>it should not be ignored</strong>.
Just because the <code class="docutils literal"><span class="pre">-maxwarn</span></code> option is available does not mean you should use it in the blind
hope of your simulation working. It will undoubtedly <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">blow up</span></a>.</p>
</div>
<div class="section" id="the-sum-of-the-two-largest-charge-group-radii-x-is-larger-than-rlist-rvdw-rcoulomb">
<h3>The sum of the two largest charge group radii (X) is larger than rlist - rvdw/rcoulomb<a class="headerlink" href="#the-sum-of-the-two-largest-charge-group-radii-x-is-larger-than-rlist-rvdw-rcoulomb" title="Permalink to this headline">¶</a></h3>
<p>This error warns that some combination of settings will result in poor energy conservation at the
longest cutoff, which occurs when charge groups move in or out of pair list range.
The error can have two sources:</p>
<ul class="simple">
<li>Your charge groups encompass too many atoms. Most charge groups should be less than 4 atoms or less.</li>
<li>Your <a class="reference internal" href="file-formats.html#mdp"><span class="std std-ref">mdp</span></a> settings are incompatible with the chosen algorithms. For switch or shift functions,
rlist must be larger than the longest cutoff (<code class="docutils literal"><span class="pre">rvdw</span></code> or <code class="docutils literal"><span class="pre">rcoulomb</span></code>) to provide buffer space for charge
groups that move beyond the neighbor searching radius. If set incorrectly, you may miss
interactions, contributing to poor energy conservation.</li>
</ul>
<p>A similar error (“The sum of the two largest charge group radii (X) is
larger than rlist”) can arise under two following circumstances:</p>
<ul class="simple">
<li>The charge groups are inappropriately large or rlist is set too low.</li>
<li>Molecules are broken across periodic boundaries, which is not a problem in a periodic system.
In this case, the sum of the two largest charge groups will correspond to a value of twice
the box vector along which the molecule is broken.</li>
</ul>
</div>
<div class="section" id="invalid-line-in-coordinate-file-for-atom-x">
<h3>Invalid line in coordinate file for atom X<a class="headerlink" href="#invalid-line-in-coordinate-file-for-atom-x" title="Permalink to this headline">¶</a></h3>
<p>This error arises if the format of the <a class="reference internal" href="file-formats.html#gro"><span class="std std-ref">gro</span></a> file is broken in some way. The
most common explanation is that the second line in the <a class="reference internal" href="file-formats.html#gro"><span class="std std-ref">gro</span></a> file specifies an incorrect
number of atoms, causing <a class="reference internal" href="../onlinehelp/gmx-grompp.html#gmx-grompp"><span class="std std-ref">grompp</span></a> to continue searching for atoms but finding box vectors.</p>
</div>
</div>
<div class="section" id="errors-in-mdrun">
<h2>Errors in <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a><a class="headerlink" href="#errors-in-mdrun" title="Permalink to this headline">¶</a></h2>
<div class="section" id="stepsize-too-small-or-no-change-in-energy-converged-to-machine-precision-but-not-to-the-requested-precision">
<h3>Stepsize too small, or no change in energy. Converged to machine precision, but not to the requested precision<a class="headerlink" href="#stepsize-too-small-or-no-change-in-energy-converged-to-machine-precision-but-not-to-the-requested-precision" title="Permalink to this headline">¶</a></h3>
<p>This is not an error as such. It is simply informing you that during the
energy minimization process
it reached the limit possible to minimize the structure with your current parameters. It does not
mean that the system has not been minimized fully, but in some situations that may be the case.
If the system has a significant amount of water present, then an E<sub>pot</sub> of the order
of -10<sup>5</sup> to -10<sup>6</sup> (in conjunction with an F<sub>max</sub> between 10
and 1000 kJ mol<sup>-1</sup> nm<sup>-1</sup>) is typically a reasonable value for
starting most MD simulations from the resulting structure. The most important result is
likely the value of F<sub>max</sub>, as it describes the slope of the potential energy
surface, i.e. how far from an energy minimum your structure lies. Only for special
purposes, such as normal mode analysis type of calculations, it may be necessary to minimize further.</p>
<p>Further minimization may be achieved by using a different energy minimization method or by
making use of double precision-enabled GROMACS.</p>
</div>
<div class="section" id="lincs-settle-shake-warnings">
<h3>LINCS/SETTLE/SHAKE warnings<a class="headerlink" href="#lincs-settle-shake-warnings" title="Permalink to this headline">¶</a></h3>
<p>Sometimes, when running dynamics, <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a> may suddenly stop (perhaps after writing
several <a class="reference internal" href="file-formats.html#pdb"><span class="std std-ref">pdb</span></a> files) after a series of warnings about the constraint algorithms
(e.g. LINCS, SETTLE or SHAKE) are written to the <a class="reference internal" href="file-formats.html#log"><span class="std std-ref">log</span></a> file. These algorithms often
used to constrain bond lengths and/or angles. When a system is <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">blowing up</span></a>
(i.e. exploding due to diverging forces), the constraints are usually the first thing to
fail. This doesn’t necessarily mean you need to troubleshoot the constraint algorithm.
Usually it is a sign of something more fundamentally wrong (physically unrealistic) with
your system. See also the advice here about <a class="reference internal" href="terminology.html#system-diagnosis"><span class="std std-ref">diagnosing unstable systems</span></a>.</p>
</div>
<div class="section" id="interaction-not-within-cut-off">
<h3>1-4 interaction not within cut-off<a class="headerlink" href="#interaction-not-within-cut-off" title="Permalink to this headline">¶</a></h3>
<p>Some of your atoms have moved so two atoms separated by three bonds are separated by more
than the cut-off distance. <strong>This is BAD</strong>. Most importantly, <strong>do not increase your cut-off</strong>!
This error actually indicates that the atoms have very large velocities, which usually means
that (part of) your molecule(s) is (are) <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">blowing up</span></a>. If you are using
LINCS for constraints, you probably also already got a number of LINCS warnings. When using
SHAKE this will give rise to a SHAKE error, which halts your simulation before the
<code class="docutils literal"><span class="pre">1-4</span> <span class="pre">not</span> <span class="pre">within</span> <span class="pre">cutoff</span></code> error can appear.</p>
<p>There can be a number of reasons for the large velocities in your system. If it happens
at the beginning of the simulation, your system might be not equilibrated well enough
(e.g. it contains some bad contacts). Try a(nother) round of energy minimization to
fix this. Otherwise you might have a very high temperature, and/or a timestep that is too
large. Experiment with these parameters until the error stops occurring. If this doesn’t help,
check the validity of the parameters in your <a class="reference internal" href="file-formats.html#top"><span class="std std-ref">topology</span></a>!</p>
</div>
<div class="section" id="simulation-running-but-no-output">
<h3>Simulation running but no output<a class="headerlink" href="#simulation-running-but-no-output" title="Permalink to this headline">¶</a></h3>
<p>Not an error as such, but mdrun appears to be chewing up CPU time but nothing is being
written to the output files. There are a number of reasons why this may occur:</p>
<ul class="simple">
<li>Your simulation might simply be (very) <a class="reference internal" href="mdrun-performance.html#gmx-performance"><span class="std std-ref">slow</span></a>, and since output is buffered, it can take quite
some time for output to appear in the respective files. If you are trying to fix some problems
and you want to get output as fast as possible, you can set the environment variable <code class="docutils literal"><span class="pre">GMX_LOG_BUFFER</span></code> to 0.</li>
<li>Something might be going wrong in your simulation, causing e.g. not-a-numbers (NAN) to be
generated (these are the result of e.g. division by zero). Subsequent calculations
with NAN’s will generate floating point exceptions which slow everything down by orders of
magnitude.</li>
<li>You might have all <code class="docutils literal"><span class="pre">nst*</span></code> parameters (see your <a class="reference internal" href="file-formats.html#mdp"><span class="std std-ref">mdp</span></a> file) set to 0, this will suppress most output.</li>
<li>Your disk might be full. Eventually this will lead to <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a> crashing, but
since output is buffered, it might take a while for mdrun to realize it can’t write.</li>
</ul>
</div>
<div class="section" id="can-not-do-conjugate-gradients-with-constraints">
<h3>Can not do Conjugate Gradients with constraints<a class="headerlink" href="#can-not-do-conjugate-gradients-with-constraints" title="Permalink to this headline">¶</a></h3>
<p>This means you can’t do energy minimization with the conjugate gradient
algorithm if your topology has constraints defined. Please check the
<a class="reference external" href="../manual-2018.3.pdf">reference manual</a>.</p>
</div>
<div class="section" id="pressure-scaling-more-than-1">
<h3>Pressure scaling more than 1%<a class="headerlink" href="#pressure-scaling-more-than-1" title="Permalink to this headline">¶</a></h3>
<p>This error tends to be generated when the simulation box begins to oscillate (due to large
pressures and / or small coupling constants), the system starts to resonate
and <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">then crashes</span></a>.
This can mean that the system isn’t equilibrated sufficiently before using pressure coupling.
Therefore, better / more equilibration may fix the issue.</p>
<p>It is recommended to observe the system trajectory prior and during the crash. This may
indicate if a particular part of the system / structure is the problem.</p>
<p>In some cases, if the system has been equilibrated sufficiently, this error can mean that the pressure
coupling constant, <a class="reference internal" href="mdp-options.html#mdp-tau-p"><code class="xref std std-mdp docutils literal"><span class="pre">tau-p</span></code></a>, is too small (particularly when using the Berendsen weak coupling method).
Increasing that value will slow down the response to pressure changes and may stop the resonance from occurring.
You are also more likely to see this error if you use Parrinello-Rahman pressure coupling
on a system that is not yet equilibrated - start with the much more forgiving
Berendsen method first, then switch to other algorithms.</p>
<p>This error can also appear when using a timestep that is too large, e.g. 5 fs,
in the absence of constraints and / or virtual sites.</p>
</div>
<div class="section" id="range-checking-error">
<h3>Range Checking error<a class="headerlink" href="#range-checking-error" title="Permalink to this headline">¶</a></h3>
<p>This usually means your simulation is <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">blowing up</span></a>. Probably you need to do better
energy minimization and/or equilibration and/or topology design.</p>
</div>
<div class="section" id="x-particles-communicated-to-pme-node-y-are-more-than-a-cell-length-out-of-the-domain-decomposition-cell-of-their-charge-group">
<h3>X particles communicated to PME node Y are more than a cell length out of the domain decomposition cell of their charge group<a class="headerlink" href="#x-particles-communicated-to-pme-node-y-are-more-than-a-cell-length-out-of-the-domain-decomposition-cell-of-their-charge-group" title="Permalink to this headline">¶</a></h3>
<p>This is another way that <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a> tells you your system is <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">blowing up</span></a>.
If you have particles
that are flying across the system, you will get this fatal error. The message indicates that some
piece of your system is tearing apart (hence out of the “cell of their charge group”). Refer to
the <a class="reference internal" href="terminology.html#blowing-up"><span class="std std-ref">Blowing Up</span></a> page for advice on how to fix this issue.</p>
</div>
<div class="section" id="a-charge-group-moved-too-far-between-two-domain-decomposition-steps">
<h3>A charge group moved too far between two domain decomposition steps.<a class="headerlink" href="#a-charge-group-moved-too-far-between-two-domain-decomposition-steps" title="Permalink to this headline">¶</a></h3>
<p>See information above.</p>
</div>
<div class="section" id="software-inconsistency-error-some-interactions-seem-to-be-assigned-multiple-times">
<h3>Software inconsistency error: Some interactions seem to be assigned multiple times<a class="headerlink" href="#software-inconsistency-error-some-interactions-seem-to-be-assigned-multiple-times" title="Permalink to this headline">¶</a></h3>
<p>See information above</p>
</div>
<div class="section" id="there-is-no-domain-decomposition-for-n-ranks-that-is-compatible-with-the-given-box-and-a-minimum-cell-size-of-x-nm">
<h3>There is no domain decomposition for n ranks that is compatible with the given box and a minimum cell size of x nm<a class="headerlink" href="#there-is-no-domain-decomposition-for-n-ranks-that-is-compatible-with-the-given-box-and-a-minimum-cell-size-of-x-nm" title="Permalink to this headline">¶</a></h3>
<p>This means you tried to run a parallel calculation, and when <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a> tried to
partition your simulation cell into chunks, it couldn’t. The minimum
cell size is controlled by the size of the largest charge group or bonded interaction and the
largest of <code class="docutils literal"><span class="pre">rvdw</span></code>, <code class="docutils literal"><span class="pre">rlist</span></code> and <code class="docutils literal"><span class="pre">rcoulomb</span></code>, some other effects of bond constraints,
and a safety margin. Thus it is not possible to run a small simulation with large numbers
of processors. So, if <a class="reference internal" href="../onlinehelp/gmx-grompp.html#gmx-grompp"><span class="std std-ref">grompp</span></a> warned you about a large charge group, pay
attention and reconsider its size. <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a> prints a breakdown of how it
computed this minimum size in the <a class="reference internal" href="file-formats.html#log"><span class="std std-ref">log</span></a> file, so you can perhaps find a cause there.</p>
<p>If you didn’t think you were running a parallel calculation, be aware that from 4.5, GROMACS
uses thread-based parallelism by default. To prevent this, give <a class="reference internal" href="../onlinehelp/gmx-mdrun.html#gmx-mdrun"><span class="std std-ref">mdrun</span></a>
the <code class="docutils literal"><span class="pre">-ntmpi</span> <span class="pre">1</span></code> command line option. Otherwise, you might be using an MPI-enabled GROMACS and
not be aware of the fact.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Common errors when using GROMACS</a><ul>
<li><a class="reference internal" href="#common-errors-during-usage">Common errors during usage</a><ul>
<li><a class="reference internal" href="#out-of-memory-when-allocating">Out of memory when allocating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#errors-in-pdb2gmx">Errors in <code class="docutils literal"><span class="pre">pdb2gmx</span></code></a><ul>
<li><a class="reference internal" href="#residue-xxx-not-found-in-residue-topology-database">Residue ‘XXX’ not found in residue topology database</a></li>
<li><a class="reference internal" href="#long-bonds-and-or-missing-atoms">Long bonds and/or missing atoms</a></li>
<li><a class="reference internal" href="#chain-identifier-x-was-used-in-two-non-sequential-blocks">Chain identifier ‘X’ was used in two non-sequential blocks</a></li>
<li><a class="reference internal" href="#warning-atom-x-is-missing-in-residue-xxx-y-in-the-pdb-file">WARNING: atom X is missing in residue XXX Y in the pdb file</a></li>
<li><a class="reference internal" href="#atom-x-in-residue-yyy-not-found-in-rtp-entry">Atom X in residue YYY not found in rtp entry</a></li>
<li><a class="reference internal" href="#no-force-fields-found-files-with-name-forcefield-itp-in-subdirectories-ending-on-ff">No force fields found (files with name ‘forcefield.itp’ in subdirectories ending on ‘.ff’)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#errors-in-grompp">Errors in <code class="docutils literal"><span class="pre">grompp</span></code></a><ul>
<li><a class="reference internal" href="#found-a-second-defaults-directive-file">Found a second defaults directive file</a></li>
<li><a class="reference internal" href="#invalid-order-for-directive-xxx">Invalid order for directive xxx</a></li>
<li><a class="reference internal" href="#atom-index-n-in-position-restraints-out-of-bounds">Atom index n in position_restraints out of bounds</a></li>
<li><a class="reference internal" href="#system-has-non-zero-total-charge">System has non-zero total charge</a></li>
<li><a class="reference internal" href="#incorrect-number-of-parameters">Incorrect number of parameters</a></li>
<li><a class="reference internal" href="#number-of-coordinates-in-coordinate-file-does-not-match-topology">Number of coordinates in coordinate file does not match topology</a></li>
<li><a class="reference internal" href="#fatal-error-no-such-moleculetype-xxx">Fatal error: No such moleculetype XXX</a></li>
<li><a class="reference internal" href="#t-coupling-group-xxx-has-fewer-than-10-of-the-atoms">T-Coupling group XXX has fewer than 10% of the atoms</a></li>
<li><a class="reference internal" href="#the-cut-off-length-is-longer-than-half-the-shortest-box-vector-or-longer-than-the-smallest-box-diagonal-element-increase-the-box-size-or-decrease-rlist">The cut-off length is longer than half the shortest box vector or longer than the smallest box diagonal element. Increase the box size or decrease rlist</a></li>
<li><a class="reference internal" href="#atom-index-1-in-bonds-out-of-bounds">Atom index (1) in bonds out of bounds</a></li>
<li><a class="reference internal" href="#xxx-non-matching-atom-names">XXX non-matching atom names</a></li>
<li><a class="reference internal" href="#the-sum-of-the-two-largest-charge-group-radii-x-is-larger-than-rlist-rvdw-rcoulomb">The sum of the two largest charge group radii (X) is larger than rlist - rvdw/rcoulomb</a></li>
<li><a class="reference internal" href="#invalid-line-in-coordinate-file-for-atom-x">Invalid line in coordinate file for atom X</a></li>
</ul>
</li>
<li><a class="reference internal" href="#errors-in-mdrun">Errors in <code class="docutils literal"><span class="pre">mdrun</span></code></a><ul>
<li><a class="reference internal" href="#stepsize-too-small-or-no-change-in-energy-converged-to-machine-precision-but-not-to-the-requested-precision">Stepsize too small, or no change in energy. Converged to machine precision, but not to the requested precision</a></li>
<li><a class="reference internal" href="#lincs-settle-shake-warnings">LINCS/SETTLE/SHAKE warnings</a></li>
<li><a class="reference internal" href="#interaction-not-within-cut-off">1-4 interaction not within cut-off</a></li>
<li><a class="reference internal" href="#simulation-running-but-no-output">Simulation running but no output</a></li>
<li><a class="reference internal" href="#can-not-do-conjugate-gradients-with-constraints">Can not do Conjugate Gradients with constraints</a></li>
<li><a class="reference internal" href="#pressure-scaling-more-than-1">Pressure scaling more than 1%</a></li>
<li><a class="reference internal" href="#range-checking-error">Range Checking error</a></li>
<li><a class="reference internal" href="#x-particles-communicated-to-pme-node-y-are-more-than-a-cell-length-out-of-the-domain-decomposition-cell-of-their-charge-group">X particles communicated to PME node Y are more than a cell length out of the domain decomposition cell of their charge group</a></li>
<li><a class="reference internal" href="#a-charge-group-moved-too-far-between-two-domain-decomposition-steps">A charge group moved too far between two domain decomposition steps.</a></li>
<li><a class="reference internal" href="#software-inconsistency-error-some-interactions-seem-to-be-assigned-multiple-times">Software inconsistency error: Some interactions seem to be assigned multiple times</a></li>
<li><a class="reference internal" href="#there-is-no-domain-decomposition-for-n-ranks-that-is-compatible-with-the-given-box-and-a-minimum-cell-size-of-x-nm">There is no domain decomposition for n ranks that is compatible with the given box and a minimum cell size of x nm</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mdrun-performance.html"
                        title="previous chapter">Getting good performance from <code class="docutils literal"><span class="pre">mdrun</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="file-formats.html"
                        title="next chapter">File formats</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user-guide/run-time-errors.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="file-formats.html" title="File formats"
             >next</a> |</li>
        <li class="right" >
          <a href="mdrun-performance.html" title="Getting good performance from mdrun"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">GROMACS 2018.3</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >User guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, GROMACS development team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.1.
    </div>
  </body>
</html>