<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Gromacs: src/gromacs/listed-forces/restcbt.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Gromacs
   &#160;<span id="projectnumber">2018.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.xhtml"><span>Modules</span></a></li>
      <li><a href="pages.xhtml"><span>Other&#160;Docs</span></a></li>
      <li><a href="namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="annotated.xhtml"><span>Classes</span></a></li>
      <li class="current"><a href="files.xhtml"><span>Files</span></a></li>
      <li><a href="examples.xhtml"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.xhtml"><span>File&#160;List</span></a></li>
      <li><a href="globals.xhtml"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8a21c46af9718d1f610eb513153099d7.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_a46192700e9e8ed44c648f0a55ee9a53.xhtml">gromacs</a></li><li class="navelem"><a class="el" href="dir_132a114f76835b4ffd11c4d86334044f.xhtml">listed-forces</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">restcbt.cpp File Reference<div class="ingroups"><a class="el" href="group__module__listed-forces.xhtml">Interactions between lists of particles</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="gmxpre_8h.xhtml">gmxpre.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="restcbt_8h.xhtml">restcbt.h</a>&quot;</code><br/>
<code>#include &lt;cmath&gt;</code><br/>
<code>#include &quot;<a class="el" href="functions_8h.xhtml">gromacs/math/functions.h</a>&quot;</code><br/>
<code>#include &quot;gromacs/math/units.h&quot;</code><br/>
<code>#include &quot;gromacs/math/utilities.h&quot;</code><br/>
<code>#include &quot;gromacs/math/vec.h&quot;</code><br/>
<code>#include &quot;gromacs/topology/idef.h&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for restcbt.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="restcbt_8cpp__incl.svg" width="430" height="202"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>This file contains function definitions necessary for computations of forces due to restricted angle, restricted dihedral and combined bending-torsion potentials. </p>
<dl class="section author"><dt>Author</dt><dd>Nicolae Goga </dd></dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a20e5ee0973cac6c90a639dece12c5495"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="restcbt_8cpp.xhtml#a20e5ee0973cac6c90a639dece12c5495">compute_factors_restangles</a> (int type, const t_iparams forceparams[], rvec delta_ante, rvec delta_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *prefactor, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *ratio_ante, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *ratio_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *v)</td></tr>
<tr class="memdesc:a20e5ee0973cac6c90a639dece12c5495"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes factors needed for restricted angle potentials.  <a href="#a20e5ee0973cac6c90a639dece12c5495">More...</a><br/></td></tr>
<tr class="separator:a20e5ee0973cac6c90a639dece12c5495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ede5f31d34b57fc752545a08939c37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="restcbt_8cpp.xhtml#ae1ede5f31d34b57fc752545a08939c37">compute_factors_restrdihs</a> (int type, const t_iparams forceparams[], rvec delta_ante, rvec delta_crnt, rvec delta_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_ai_ante, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_ai_crnt, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_ai_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_aj_ante, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_aj_crnt, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_aj_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_ak_ante, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_ak_crnt, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_ak_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_al_ante, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_al_crnt, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *factor_phi_al_post, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *prefactor_phi, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *v)</td></tr>
<tr class="memdesc:ae1ede5f31d34b57fc752545a08939c37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute factors for restricted dihedral potentials.  <a href="#ae1ede5f31d34b57fc752545a08939c37">More...</a><br/></td></tr>
<tr class="separator:ae1ede5f31d34b57fc752545a08939c37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96465d7ce23b11c49d9ae466eb68b179"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="restcbt_8cpp.xhtml#a96465d7ce23b11c49d9ae466eb68b179">compute_factors_cbtdihs</a> (int type, const t_iparams forceparams[], rvec delta_ante, rvec delta_crnt, rvec delta_post, rvec f_phi_ai, rvec f_phi_aj, rvec f_phi_ak, rvec f_phi_al, rvec f_theta_ante_ai, rvec f_theta_ante_aj, rvec f_theta_ante_ak, rvec f_theta_post_aj, rvec f_theta_post_ak, rvec f_theta_post_al, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *v)</td></tr>
<tr class="memdesc:a96465d7ce23b11c49d9ae466eb68b179"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute factors for combined bending-torsion (CBT) potentials.  <a href="#a96465d7ce23b11c49d9ae466eb68b179">More...</a><br/></td></tr>
<tr class="separator:a96465d7ce23b11c49d9ae466eb68b179"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a96465d7ce23b11c49d9ae466eb68b179"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_factors_cbtdihs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_iparams&#160;</td>
          <td class="paramname"><em>forceparams</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_crnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_phi_ai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_phi_aj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_phi_ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_phi_al</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_theta_ante_ai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_theta_ante_aj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_theta_ante_ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_theta_post_aj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_theta_post_ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f_theta_post_al</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute factors for combined bending-torsion (CBT) potentials. </p>
<p>The combined bending-torsion potential goes to zero in a very smooth manner, eliminating the numerical instabilities, when three coarse-grained particles align and the dihedral angle and standard dihedral potentials cannot be calculated. The CBT potential is calculated using the formula: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[V_{\rm CBT}(\theta_{i-1}, \theta_i, \phi_i) = k_{\phi} \sin^3\theta_{i-1} \sin^3\theta_{i} \sum_{n=0}^4 { a_n \cos^n\phi_i}\]" src="form_6.png"/>
</p>
<p> (see section "Proper dihedrals: Combined bending-torsion potential" from the manual). It contains in its expression not only the dihedral angle <img class="formulaInl" alt="$\phi$" src="form_7.png"/> but also <img class="formulaInl" alt="$\theta_{i-1}$" src="form_8.png"/> (denoted as theta_ante below) and <img class="formulaInl" alt="$\theta_{i}$" src="form_9.png"/> (denoted as theta_post below) &mdash; the adjacent bending angles. The derivative of the CBT potential is calculated as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\frac{\partial V_{\rm CBT}(\theta_{i-1},\theta_i,\phi_i)} {\partial \vec r_{l}} = \frac{\partial V_ {\rm CBT}}{\partial \theta_{i-1}} \frac{\partial \theta_{i-1}}{\partial \vec r_{l}} + \frac{\partial V_{\rm CBT}}{\partial \phi_{i }} \frac{\partial \phi_{i }}{\partial \vec r_{l}}\]" src="form_10.png"/>
</p>
<p> where all the derivatives of the angles with respect to Cartesian coordinates are calculated as in Allen &amp; Tildesley (pp. 330-332). Factors f_phi_* come from the derivatives of the torsion angle with respect to the beads ai, aj, ak, al (four) coordinates; f_theta_ante_* come from the derivatives of the bending angle theta_ante (theta_{i-1} in formula above) with respect to the beads ai, aj, ak (three particles) coordinates and f_theta_post_* come from the derivatives of the bending angle theta_post (theta_{i} in formula above) with respect to the beads aj, ak, al (three particles) coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>type of force parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forceparams</td><td>array of parameters for force computations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_ante</td><td>distance between the first two particles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_crnt</td><td>distance between the middle pair of particles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_post</td><td>distance between the last two particles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_phi_ai</td><td>force for particle ai due to derivative in phi angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_phi_aj</td><td>force for particle aj due to derivative in phi angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_phi_ak</td><td>force for particle ak due to derivative in phi angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_phi_al</td><td>force for particle al due to derivative in phi angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_theta_ante_ai</td><td>force for particle ai due to derivative in theta_ante angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_theta_ante_aj</td><td>force for particle aj due to derivative in theta_ante angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_theta_ante_ak</td><td>force for particle ak due to derivative in theta_ante angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_theta_post_aj</td><td>force for particle aj due to derivative in theta_post angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_theta_post_ak</td><td>force for particle ak due to derivative in theta_post angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f_theta_post_al</td><td>force for particle al due to derivative in theta_psot angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>contribution to energy (see formula above) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a20e5ee0973cac6c90a639dece12c5495"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_factors_restangles </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_iparams&#160;</td>
          <td class="paramname"><em>forceparams</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>prefactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>ratio_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>ratio_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes factors needed for restricted angle potentials. </p>
<p>The restricted angle potential is used in coarse-grained simulations to avoid singularities when three particles align and the dihedral angle and dihedral potential cannot be calculated. This potential is calculated using the formula: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[V_{\rm ReB}(\theta_i) = \frac{1}{2} k_{\theta} \frac{(\cos\theta_i - \cos\theta_0)^2}{\sin^2\theta_i}\]" src="form_2.png"/>
</p>
<p> (see section "Restricted Bending Potential" from the manual). The derivative of the restricted angle potential is calculated as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\frac{\partial V_{\rm ReB}(\theta_i)} {\partial \vec r_{k}} = \frac{dV_{\rm ReB}(\theta_i)}{dcos\theta_i} \frac{\partial cos\theta_i}{\partial \vec r_{k}}\]" src="form_3.png"/>
</p>
<p> where all the derivatives of the bending angle with respect to Cartesian coordinates are calculated as in Allen &amp; Tildesley (pp. 330-332)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>type of force parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forceparams</td><td>array of parameters for force computations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_ante</td><td>distance between the first two particles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_post</td><td>distance between the last two particles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prefactor</td><td>common term that comes in front of each force </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ratio_ante</td><td>ratio of scalar products of delta_ante with delta_post and delta_ante with delta_ante </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ratio_post</td><td>ratio of scalar products of delta_ante with delta_post and delta_post with delta_ante </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>contribution to energy (see formula above) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae1ede5f31d34b57fc752545a08939c37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_factors_restrdihs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_iparams&#160;</td>
          <td class="paramname"><em>forceparams</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_crnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>delta_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_ai_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_ai_crnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_ai_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_aj_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_aj_crnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_aj_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_ak_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_ak_crnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_ak_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_al_ante</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_al_crnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>factor_phi_al_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>prefactor_phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute factors for restricted dihedral potentials. </p>
<p>The restricted dihedral potential is the equivalent of the restricted bending potential for the dihedral angle. It imposes the dihedral angle to have only one equilibrium value. This potential is calculated using the formula: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[V_{\rm ReT}(\phi_i) = \frac{1}{2} k_{\phi} \frac{(\cos\phi_i - \cos\phi_0)^2}{\sin^2\phi_i}\]" src="form_4.png"/>
</p>
<p> (see section "Proper dihedrals: Restricted torsion potential" from the manual). The derivative of the restricted dihedral potential is calculated as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\frac{\partial V_{\rm ReT}(\phi_i)} {\partial \vec r_{k}} = \frac{dV_{\rm ReT}(\phi_i)}{dcos\phi_i} \frac{\partial cos\phi_i}{\partial \vec r_{k}}\]" src="form_5.png"/>
</p>
<p> where all the derivatives of the dihedral angle with respect to Cartesian coordinates are calculated as in Allen &amp; Tildesley (pp. 330-332). Factors factor_phi_* are coming from the derivatives of the torsion angle (phi) with respect to the beads ai, aj, ak, al, (four) coordinates and they are multiplied in the force computations with the particle distance stored in parameters delta_ante, delta_crnt, delta_post.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>type of force parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forceparams</td><td>array of parameters for force computations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_ante</td><td>distance between the first two particles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_crnt</td><td>distance between the middle pair of particles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_post</td><td>distance between the last two particles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_ai_ante</td><td>force factor for particle ai multiplied with delta_ante </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_ai_crnt</td><td>force factor for particle ai multiplied with delta_crnt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_ai_post</td><td>force factor for particle ai multiplied with delta_post </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_aj_ante</td><td>force factor for particle aj multiplied with delta_ante </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_aj_crnt</td><td>force factor for particle aj multiplied with delta_crnt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_aj_post</td><td>force factor for particle aj multiplied with delta_post </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_ak_ante</td><td>force factor for particle ak multiplied with delta_ante </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_ak_crnt</td><td>force factor for particle ak multiplied with delta_crnt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_ak_post</td><td>force factor for particle ak multiplied with delta_post </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_al_ante</td><td>force factor for particle al multiplied with delta_ante </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_al_crnt</td><td>force factor for particle al multiplied with delta_crnt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor_phi_al_post</td><td>force factor for particle al multiplied with delta_post </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prefactor_phi</td><td>multiplication constant of the torsion force </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>contribution to energy (see formula above) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Aug 23 2018 14:57:17 for Gromacs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
