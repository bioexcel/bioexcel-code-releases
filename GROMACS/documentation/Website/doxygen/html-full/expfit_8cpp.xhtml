<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Gromacs: src/gromacs/correlationfunctions/expfit.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Gromacs
   &#160;<span id="projectnumber">2018.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.xhtml"><span>Modules</span></a></li>
      <li><a href="pages.xhtml"><span>Other&#160;Docs</span></a></li>
      <li><a href="namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="annotated.xhtml"><span>Classes</span></a></li>
      <li class="current"><a href="files.xhtml"><span>Files</span></a></li>
      <li><a href="examples.xhtml"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.xhtml"><span>File&#160;List</span></a></li>
      <li><a href="globals.xhtml"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8a21c46af9718d1f610eb513153099d7.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_a46192700e9e8ed44c648f0a55ee9a53.xhtml">gromacs</a></li><li class="navelem"><a class="el" href="dir_014a9b7944bd224a57074a436acb6ed9.xhtml">correlationfunctions</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">expfit.cpp File Reference<div class="ingroups"><a class="el" href="group__module__correlationfunctions.xhtml">Correlation functions</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="gmxpre_8h.xhtml">gmxpre.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="expfit_8h.xhtml">expfit.h</a>&quot;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;algorithm&gt;</code><br/>
<code>#include &lt;lmstruct.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="integrate_8h.xhtml">gromacs/correlationfunctions/integrate.h</a>&quot;</code><br/>
<code>#include &quot;gromacs/fileio/xvgr.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="functions_8h.xhtml">gromacs/math/functions.h</a>&quot;</code><br/>
<code>#include &quot;gromacs/math/vec.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="fatalerror_8h.xhtml">gromacs/utility/fatalerror.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="futil_8h.xhtml">gromacs/utility/futil.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gmxassert_8h.xhtml">gromacs/utility/gmxassert.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="real_8h.xhtml">gromacs/utility/real.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="smalloc_8h.xhtml">gromacs/utility/smalloc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gmx__lmcurve_8h.xhtml">gmx_lmcurve.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for expfit.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="expfit_8cpp__incl.svg" width="1827" height="306"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>Implements routine for fitting a data set to a curve. </p>
<dl class="section author"><dt>Author</dt><dd>David van der Spoel <a href="#" onclick="location.href='mai'+'lto:'+'dav'+'id'+'.va'+'nd'+'ers'+'po'+'el@'+'ic'+'m.u'+'u.'+'se'; return false;">david<span style="display: none;">.nosp@m.</span>.van<span style="display: none;">.nosp@m.</span>dersp<span style="display: none;">.nosp@m.</span>oel@<span style="display: none;">.nosp@m.</span>icm.u<span style="display: none;">.nosp@m.</span>u.se</a> </dd></dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a387b8b27f28e3018e2f1d96bbb75cc3d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a387b8b27f28e3018e2f1d96bbb75cc3d"></a>
typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a387b8b27f28e3018e2f1d96bbb75cc3d">t_lmcurve</a> )(double x, const double *a)</td></tr>
<tr class="memdesc:a387b8b27f28e3018e2f1d96bbb75cc3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">function type for passing to fitting routine <br/></td></tr>
<tr class="separator:a387b8b27f28e3018e2f1d96bbb75cc3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a116cccea41845ea588fc00c5dc0f7dce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a116cccea41845ea588fc00c5dc0f7dce">effnNparams</a> (int effn)</td></tr>
<tr class="memdesc:a116cccea41845ea588fc00c5dc0f7dce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns number of function parameters associated with a fitting function.  <a href="#a116cccea41845ea588fc00c5dc0f7dce">More...</a><br/></td></tr>
<tr class="separator:a116cccea41845ea588fc00c5dc0f7dce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f046b3f2286043e6c447498703f126"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#ae3f046b3f2286043e6c447498703f126">effnDescription</a> (int effn)</td></tr>
<tr class="memdesc:ae3f046b3f2286043e6c447498703f126"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns description corresponding to the enum above, or NULL if out of range.  <a href="#ae3f046b3f2286043e6c447498703f126">More...</a><br/></td></tr>
<tr class="separator:ae3f046b3f2286043e6c447498703f126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f2f7deddf6696f3eebe0f5605808b63"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a7f2f7deddf6696f3eebe0f5605808b63">sffn2effn</a> (const char **sffn)</td></tr>
<tr class="memdesc:a7f2f7deddf6696f3eebe0f5605808b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns corresponding to the selected enum option in sffn.  <a href="#a7f2f7deddf6696f3eebe0f5605808b63">More...</a><br/></td></tr>
<tr class="separator:a7f2f7deddf6696f3eebe0f5605808b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ecc8ac1a3e2b6ce4bd41592d584ec5c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5ecc8ac1a3e2b6ce4bd41592d584ec5c"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a5ecc8ac1a3e2b6ce4bd41592d584ec5c">myexp</a> (double x, double A, double tau)</td></tr>
<tr class="memdesc:a5ecc8ac1a3e2b6ce4bd41592d584ec5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute exponential function A exp(-x/tau) <br/></td></tr>
<tr class="separator:a5ecc8ac1a3e2b6ce4bd41592d584ec5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f73c128d077680c37f2deebc929f92"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3f73c128d077680c37f2deebc929f92"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#ac3f73c128d077680c37f2deebc929f92">lmc_erffit</a> (double x, const double *a)</td></tr>
<tr class="memdesc:ac3f73c128d077680c37f2deebc929f92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute y=(a0+a1)/2-(a0-a1)/2*erf((x-a2)/a3^2) <br/></td></tr>
<tr class="separator:ac3f73c128d077680c37f2deebc929f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f061218008fe0f7c1b7fb7bd7c5e44b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4f061218008fe0f7c1b7fb7bd7c5e44b"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a4f061218008fe0f7c1b7fb7bd7c5e44b">safe_exp</a> (double x)</td></tr>
<tr class="memdesc:a4f061218008fe0f7c1b7fb7bd7c5e44b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exponent function that prevents overflow. <br/></td></tr>
<tr class="separator:a4f061218008fe0f7c1b7fb7bd7c5e44b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77cdc89d8216490859461a4384c5c37a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a77cdc89d8216490859461a4384c5c37a"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a77cdc89d8216490859461a4384c5c37a">safe_expm1</a> (double x)</td></tr>
<tr class="memdesc:a77cdc89d8216490859461a4384c5c37a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exponent minus 1 function that prevents overflow. <br/></td></tr>
<tr class="separator:a77cdc89d8216490859461a4384c5c37a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ac3e99f76d0174254384e354f4bedd2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ac3e99f76d0174254384e354f4bedd2"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a4ac3e99f76d0174254384e354f4bedd2">lmc_exp_one_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a4ac3e99f76d0174254384e354f4bedd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute y = exp(-x/|a0|) <br/></td></tr>
<tr class="separator:a4ac3e99f76d0174254384e354f4bedd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66884edf75e04320f3582ea964bc308"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad66884edf75e04320f3582ea964bc308"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#ad66884edf75e04320f3582ea964bc308">lmc_exp_two_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:ad66884edf75e04320f3582ea964bc308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute y = a1 exp(-x/|a0|) <br/></td></tr>
<tr class="separator:ad66884edf75e04320f3582ea964bc308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ec7c3d892fe2465148ad4f96e8828c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a19ec7c3d892fe2465148ad4f96e8828c"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a19ec7c3d892fe2465148ad4f96e8828c">lmc_exp_exp</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a19ec7c3d892fe2465148ad4f96e8828c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute y = a1 exp(-x/|a0|) + (1-a1) exp(-x/|a2|) <br/></td></tr>
<tr class="separator:a19ec7c3d892fe2465148ad4f96e8828c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a820ce3881e566aaacf844e6c186ffbdf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a820ce3881e566aaacf844e6c186ffbdf"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a820ce3881e566aaacf844e6c186ffbdf">lmc_exp_5_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a820ce3881e566aaacf844e6c186ffbdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute y = a0 exp(-x/|a1|) + a2 exp(-x/(|a1|+|a3|)) + a4. <br/></td></tr>
<tr class="separator:a820ce3881e566aaacf844e6c186ffbdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37ccaa07967f4b4e54f3a440b2e93932"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a37ccaa07967f4b4e54f3a440b2e93932">lmc_exp_7_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a37ccaa07967f4b4e54f3a440b2e93932"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute 7 parameter exponential function value.  <a href="#a37ccaa07967f4b4e54f3a440b2e93932">More...</a><br/></td></tr>
<tr class="separator:a37ccaa07967f4b4e54f3a440b2e93932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4ac9f1d41c9f671406477cbc8e0947"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a2f4ac9f1d41c9f671406477cbc8e0947">lmc_exp_9_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a2f4ac9f1d41c9f671406477cbc8e0947"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute 9 parameter exponential function value.  <a href="#a2f4ac9f1d41c9f671406477cbc8e0947">More...</a><br/></td></tr>
<tr class="separator:a2f4ac9f1d41c9f671406477cbc8e0947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6a1f07dff0447c6961c4abce29be7a4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af6a1f07dff0447c6961c4abce29be7a4"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#af6a1f07dff0447c6961c4abce29be7a4">lmc_pres_6_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:af6a1f07dff0447c6961c4abce29be7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute y = (1-a0)*exp(-(x/|a2|)^|a3|)*cos(x*|a1|) + a0*exp(-(x/|a4|)^|a5|) <br/></td></tr>
<tr class="separator:af6a1f07dff0447c6961c4abce29be7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8913f15b4dae1a635117107dedd1b033"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8913f15b4dae1a635117107dedd1b033"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a8913f15b4dae1a635117107dedd1b033">lmc_vac_2_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a8913f15b4dae1a635117107dedd1b033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute vac function. <br/></td></tr>
<tr class="separator:a8913f15b4dae1a635117107dedd1b033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9806be64773ad64b46c6df69ffd0fca0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9806be64773ad64b46c6df69ffd0fca0"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a9806be64773ad64b46c6df69ffd0fca0">lmc_errest_3_parm</a> (double x, const double *a)</td></tr>
<tr class="memdesc:a9806be64773ad64b46c6df69ffd0fca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute error estimate. <br/></td></tr>
<tr class="separator:a9806be64773ad64b46c6df69ffd0fca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22c8e7646cd3811775f2a02a66799964"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a22c8e7646cd3811775f2a02a66799964">fit_function</a> (const int eFitFn, const double parm[], const double x)</td></tr>
<tr class="memdesc:a22c8e7646cd3811775f2a02a66799964"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the value of fit function eFitFn at x.  <a href="#a22c8e7646cd3811775f2a02a66799964">More...</a><br/></td></tr>
<tr class="separator:a22c8e7646cd3811775f2a02a66799964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337e411b7f26c8fc8148d95bc0459c75"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a337e411b7f26c8fc8148d95bc0459c75">lmfit_exp</a> (int nfit, const double x[], const double y[], const double dy[], double parm[], <a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a> bVerbose, int eFitFn, int nfix)</td></tr>
<tr class="memdesc:a337e411b7f26c8fc8148d95bc0459c75"><td class="mdescLeft">&#160;</td><td class="mdescRight">lmfit_exp supports fitting of different functions  <a href="#a337e411b7f26c8fc8148d95bc0459c75">More...</a><br/></td></tr>
<tr class="separator:a337e411b7f26c8fc8148d95bc0459c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5a14b4d792f8dcb34d3b24cfa7fcf28"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#af5a14b4d792f8dcb34d3b24cfa7fcf28">initiate_fit_params</a> (int eFitFn, double params[])</td></tr>
<tr class="memdesc:af5a14b4d792f8dcb34d3b24cfa7fcf28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure the fitting parameters are well-behaved.  <a href="#af5a14b4d792f8dcb34d3b24cfa7fcf28">More...</a><br/></td></tr>
<tr class="separator:af5a14b4d792f8dcb34d3b24cfa7fcf28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49f5dfe7d1124d4afa2345a065c0e0a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#ac49f5dfe7d1124d4afa2345a065c0e0a">extract_fit_params</a> (int eFitFn, double params[])</td></tr>
<tr class="memdesc:ac49f5dfe7d1124d4afa2345a065c0e0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the fitting parameters to get output parameters.  <a href="#ac49f5dfe7d1124d4afa2345a065c0e0a">More...</a><br/></td></tr>
<tr class="separator:ac49f5dfe7d1124d4afa2345a065c0e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0d5c84278351b2f9cbb82c034012de5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad0d5c84278351b2f9cbb82c034012de5"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#ad0d5c84278351b2f9cbb82c034012de5">print_chi2_params</a> (FILE *fp, const int eFitFn, const double fitparms[], const char *label, const int nfitpnts, const double x[], const double y[])</td></tr>
<tr class="memdesc:ad0d5c84278351b2f9cbb82c034012de5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print chi-squared value and the parameters. <br/></td></tr>
<tr class="separator:ad0d5c84278351b2f9cbb82c034012de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c46c22dccbf0e6e468166d2b88c69d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a0c46c22dccbf0e6e468166d2b88c69d2">do_lmfit</a> (int ndata, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> c1[], <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> sig[], <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> dt, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *x0, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> begintimefit, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> endtimefit, const gmx_output_env_t *oenv, <a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a> bVerbose, int eFitFn, double fitparms[], int fix, const char *fn_fitted)</td></tr>
<tr class="memdesc:a0c46c22dccbf0e6e468166d2b88c69d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Levenberg-Marquardt method to fit to a nfitparm parameter exponential or to a transverse current autocorrelation function.  <a href="#a0c46c22dccbf0e6e468166d2b88c69d2">More...</a><br/></td></tr>
<tr class="separator:a0c46c22dccbf0e6e468166d2b88c69d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560ea7d97277b9e0576776ec695fb9b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a560ea7d97277b9e0576776ec695fb9b3">fit_acf</a> (int ncorr, int fitfn, const gmx_output_env_t *oenv, <a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a> bVerbose, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> tbeginfit, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> tendfit, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> dt, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> c1[], <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *fit)</td></tr>
<tr class="memdesc:a560ea7d97277b9e0576776ec695fb9b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit an autocorrelation function to a pre-defined functional form.  <a href="#a560ea7d97277b9e0576776ec695fb9b3">More...</a><br/></td></tr>
<tr class="separator:a560ea7d97277b9e0576776ec695fb9b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0381a3f406e1b936be009fb50c833804"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0381a3f406e1b936be009fb50c833804"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a0381a3f406e1b936be009fb50c833804">nfp_ffn</a> [effnNR] = { 0, 1, 2, 3, 5, 7, 9, 2, 4, 3, 6 }</td></tr>
<tr class="memdesc:a0381a3f406e1b936be009fb50c833804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of parameters for each fitting function. <br/></td></tr>
<tr class="separator:a0381a3f406e1b936be009fb50c833804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5348612f872710564767a5d1a0332e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a8c5348612f872710564767a5d1a0332e">s_ffn</a> [effnNR+2]</td></tr>
<tr class="memdesc:a8c5348612f872710564767a5d1a0332e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Short name of each function type. This is exported for now in order to use when calling parse_common_args.  <a href="#a8c5348612f872710564767a5d1a0332e">More...</a><br/></td></tr>
<tr class="separator:a8c5348612f872710564767a5d1a0332e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a740d0a52199e66c0e9b00f92e894293a"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a740d0a52199e66c0e9b00f92e894293a">longs_ffn</a> [effnNR]</td></tr>
<tr class="memdesc:a740d0a52199e66c0e9b00f92e894293a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Long description for each fitting function type.  <a href="#a740d0a52199e66c0e9b00f92e894293a">More...</a><br/></td></tr>
<tr class="separator:a740d0a52199e66c0e9b00f92e894293a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06026c9343ea8ff3591390995f1b2158"><td class="memItemLeft" align="right" valign="top"><a class="el" href="expfit_8cpp.xhtml#a387b8b27f28e3018e2f1d96bbb75cc3d">t_lmcurve</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expfit_8cpp.xhtml#a06026c9343ea8ff3591390995f1b2158">lmcurves</a> [effnNR+1]</td></tr>
<tr class="memdesc:a06026c9343ea8ff3591390995f1b2158"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of fitting functions corresponding to the pre-defined types  <a href="#a06026c9343ea8ff3591390995f1b2158">More...</a><br/></td></tr>
<tr class="separator:a06026c9343ea8ff3591390995f1b2158"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0c46c22dccbf0e6e468166d2b88c69d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> do_lmfit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>c1</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>begintimefit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>endtimefit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gmx_output_env_t *&#160;</td>
          <td class="paramname"><em>oenv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bVerbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eFitFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fitparms</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn_fitted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use Levenberg-Marquardt method to fit to a nfitparm parameter exponential or to a transverse current autocorrelation function. </p>
<p>If x == NULL, the timestep dt will be used to create a time axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ndata</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c1</td><td>The data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>The standard deviation in the points (can be NULL) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x0</td><td>The X-axis (may be NULL, see above) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">begintimefit</td><td>Starting time for fitting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endtimefit</td><td>Ending time for fitting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oenv</td><td>Output formatting information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bVerbose</td><td>Should the routine write to console? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eFitFn</td><td>Fitting function (0 .. effnNR) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fitparms[]</td><td>Fitting parameters, see printed manual for a detailed description. Note that in all implemented cases the parameters corresponding to time constants will be generated with increasing values. Such input parameters should therefore be provided in increasing order. If this is not the case or if subsequent time parameters differ by less than a factor of 2, they will be modified to ensure tau_i+1 &gt;= 2 tau_i. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fix</td><td>Constrains fit parameter i at it's starting value, when the i'th bit of fix is set. This works only when the N last parameters are fixed but not when a parameter somewhere in the middle needs to be fixed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fn_fitted</td><td>If not NULL file to print the data and fitted curve to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>integral. </dd></dl>

</div>
</div>
<a class="anchor" id="ae3f046b3f2286043e6c447498703f126"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* effnDescription </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>effn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns description corresponding to the enum above, or NULL if out of range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">effn</td><td>Index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Description or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a116cccea41845ea588fc00c5dc0f7dce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int effnNparams </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>effn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns number of function parameters associated with a fitting function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">effn</td><td>Index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number or -1 if index out of range </dd></dl>

</div>
</div>
<a class="anchor" id="ac49f5dfe7d1124d4afa2345a065c0e0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void extract_fit_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eFitFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>params</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the fitting parameters to get output parameters. </p>
<p>See comment at the previous function. </p>

</div>
</div>
<a class="anchor" id="a560ea7d97277b9e0576776ec695fb9b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> fit_acf </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncorr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fitfn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gmx_output_env_t *&#160;</td>
          <td class="paramname"><em>oenv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bVerbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>tbeginfit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>tendfit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>c1</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> *&#160;</td>
          <td class="paramname"><em>fit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit an autocorrelation function to a pre-defined functional form. </p>
<dl class="todo"><dt><b><a class="el" href="todo.xhtml#_todo000015">Todo:</a></b></dt><dd>check parameters </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ncorr</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fitfn</td><td>Fitting function (0 .. effnNR) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oenv</td><td>Output formatting information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bVerbose</td><td>Should the routine write to console? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbeginfit</td><td>Starting time for fitting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tendfit</td><td>Ending time for fitting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c1</td><td>The data points </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fit</td><td>The fitting parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the integral over the autocorrelation function? </dd></dl>

</div>
</div>
<a class="anchor" id="a22c8e7646cd3811775f2a02a66799964"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fit_function </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>eFitFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>parm</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the value of fit function eFitFn at x. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">eFitFn</td><td>the index to the fitting function (0 .. effnNR) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parm</td><td>Array of parameters, the length of which depends on eFitFn </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The value of x </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value of the fit </dd></dl>

</div>
</div>
<a class="anchor" id="af5a14b4d792f8dcb34d3b24cfa7fcf28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void initiate_fit_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eFitFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>params</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure the fitting parameters are well-behaved. </p>
<p>In order to make sure that fitting behaves according to the constraint that time constants are positive and increasing we enforce this here by setting all time constants to their absolute value and by adding e.g. |a_0| to |a_2|. This is done in conjunction with the fitting functions themselves. When there are multiple time constants we make sure that the successive time constants are at least double the previous ones and during fitting we enforce the they remain larger. It may very well help the convergence of the fitting routine. </p>

</div>
</div>
<a class="anchor" id="a37ccaa07967f4b4e54f3a440b2e93932"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double lmc_exp_7_parm </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute 7 parameter exponential function value. </p>
<p>Compute y = a0 exp(-x/|a1|) + a2 exp(-x/(|a1|+|a3|)) + a4 exp(-x/(|a1|+|a3|+|a5|)) + a6 </p>

</div>
</div>
<a class="anchor" id="a2f4ac9f1d41c9f671406477cbc8e0947"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double lmc_exp_9_parm </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute 9 parameter exponential function value. </p>
<p>Compute y = a0 exp(-x/|a1|) + a2 exp(-x/(|a1|+|a3|)) + a4 exp(-x/(|a1|+|a3|+|a5|)) + a6 exp(-x/(|a1|+|a3|+|a5|+|a7|)) + a8 </p>

</div>
</div>
<a class="anchor" id="a337e411b7f26c8fc8148d95bc0459c75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a> lmfit_exp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>y</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dy</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>parm</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bVerbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eFitFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>lmfit_exp supports fitting of different functions </p>
<p>This routine calls the Levenberg-Marquardt non-linear fitting routine for fitting a data set with errors to a target function. Fitting routines included in gromacs in src/external/lmfit. </p>

</div>
</div>
<a class="anchor" id="a7f2f7deddf6696f3eebe0f5605808b63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sffn2effn </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>sffn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns corresponding to the selected enum option in sffn. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sffn</td><td>Two dimensional string array coming from parse_common_args </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the ffn enum </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a06026c9343ea8ff3591390995f1b2158"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="expfit_8cpp.xhtml#a387b8b27f28e3018e2f1d96bbb75cc3d">t_lmcurve</a> lmcurves[effnNR+1]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <a class="code" href="expfit_8cpp.xhtml#a4ac3e99f76d0174254384e354f4bedd2">lmc_exp_one_parm</a>, <a class="code" href="expfit_8cpp.xhtml#a4ac3e99f76d0174254384e354f4bedd2">lmc_exp_one_parm</a>, <a class="code" href="expfit_8cpp.xhtml#ad66884edf75e04320f3582ea964bc308">lmc_exp_two_parm</a>,</div>
<div class="line">    <a class="code" href="expfit_8cpp.xhtml#a19ec7c3d892fe2465148ad4f96e8828c">lmc_exp_exp</a>,      <a class="code" href="expfit_8cpp.xhtml#a820ce3881e566aaacf844e6c186ffbdf">lmc_exp_5_parm</a>,   <a class="code" href="expfit_8cpp.xhtml#a37ccaa07967f4b4e54f3a440b2e93932">lmc_exp_7_parm</a>,</div>
<div class="line">    <a class="code" href="expfit_8cpp.xhtml#a2f4ac9f1d41c9f671406477cbc8e0947">lmc_exp_9_parm</a>,</div>
<div class="line">    <a class="code" href="expfit_8cpp.xhtml#a8913f15b4dae1a635117107dedd1b033">lmc_vac_2_parm</a>,   <a class="code" href="expfit_8cpp.xhtml#ac3f73c128d077680c37f2deebc929f92">lmc_erffit</a>,  <a class="code" href="expfit_8cpp.xhtml#a9806be64773ad64b46c6df69ffd0fca0">lmc_errest_3_parm</a>, <a class="code" href="expfit_8cpp.xhtml#af6a1f07dff0447c6961c4abce29be7a4">lmc_pres_6_parm</a></div>
<div class="line">}</div>
<div class="ttc" id="expfit_8cpp_xhtml_a8913f15b4dae1a635117107dedd1b033"><div class="ttname"><a href="expfit_8cpp.xhtml#a8913f15b4dae1a635117107dedd1b033">lmc_vac_2_parm</a></div><div class="ttdeci">static double lmc_vac_2_parm(double x, const double *a)</div><div class="ttdoc">Compute vac function. </div><div class="ttdef"><b>Definition:</b> expfit.cpp:310</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_a4ac3e99f76d0174254384e354f4bedd2"><div class="ttname"><a href="expfit_8cpp.xhtml#a4ac3e99f76d0174254384e354f4bedd2">lmc_exp_one_parm</a></div><div class="ttdeci">static double lmc_exp_one_parm(double x, const double *a)</div><div class="ttdoc">Compute y = exp(-x/|a0|) </div><div class="ttdef"><b>Definition:</b> expfit.cpp:213</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_ac3f73c128d077680c37f2deebc929f92"><div class="ttname"><a href="expfit_8cpp.xhtml#ac3f73c128d077680c37f2deebc929f92">lmc_erffit</a></div><div class="ttdeci">static double lmc_erffit(double x, const double *a)</div><div class="ttdoc">Compute y=(a0+a1)/2-(a0-a1)/2*erf((x-a2)/a3^2) </div><div class="ttdef"><b>Definition:</b> expfit.cpp:149</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_a820ce3881e566aaacf844e6c186ffbdf"><div class="ttname"><a href="expfit_8cpp.xhtml#a820ce3881e566aaacf844e6c186ffbdf">lmc_exp_5_parm</a></div><div class="ttdeci">static double lmc_exp_5_parm(double x, const double *a)</div><div class="ttdoc">Compute y = a0 exp(-x/|a1|) + a2 exp(-x/(|a1|+|a3|)) + a4. </div><div class="ttdef"><b>Definition:</b> expfit.cpp:235</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_a9806be64773ad64b46c6df69ffd0fca0"><div class="ttname"><a href="expfit_8cpp.xhtml#a9806be64773ad64b46c6df69ffd0fca0">lmc_errest_3_parm</a></div><div class="ttdeci">static double lmc_errest_3_parm(double x, const double *a)</div><div class="ttdoc">Compute error estimate. </div><div class="ttdef"><b>Definition:</b> expfit.cpp:358</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_ad66884edf75e04320f3582ea964bc308"><div class="ttname"><a href="expfit_8cpp.xhtml#ad66884edf75e04320f3582ea964bc308">lmc_exp_two_parm</a></div><div class="ttdeci">static double lmc_exp_two_parm(double x, const double *a)</div><div class="ttdoc">Compute y = a1 exp(-x/|a0|) </div><div class="ttdef"><b>Definition:</b> expfit.cpp:219</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_a2f4ac9f1d41c9f671406477cbc8e0947"><div class="ttname"><a href="expfit_8cpp.xhtml#a2f4ac9f1d41c9f671406477cbc8e0947">lmc_exp_9_parm</a></div><div class="ttdeci">static double lmc_exp_9_parm(double x, const double *a)</div><div class="ttdoc">Compute 9 parameter exponential function value. </div><div class="ttdef"><b>Definition:</b> expfit.cpp:268</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_af6a1f07dff0447c6961c4abce29be7a4"><div class="ttname"><a href="expfit_8cpp.xhtml#af6a1f07dff0447c6961c4abce29be7a4">lmc_pres_6_parm</a></div><div class="ttdeci">static double lmc_pres_6_parm(double x, const double *a)</div><div class="ttdoc">Compute y = (1-a0)*exp(-(x/|a2|)^|a3|)*cos(x*|a1|) + a0*exp(-(x/|a4|)^|a5|) </div><div class="ttdef"><b>Definition:</b> expfit.cpp:286</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_a19ec7c3d892fe2465148ad4f96e8828c"><div class="ttname"><a href="expfit_8cpp.xhtml#a19ec7c3d892fe2465148ad4f96e8828c">lmc_exp_exp</a></div><div class="ttdeci">static double lmc_exp_exp(double x, const double *a)</div><div class="ttdoc">Compute y = a1 exp(-x/|a0|) + (1-a1) exp(-x/|a2|) </div><div class="ttdef"><b>Definition:</b> expfit.cpp:225</div></div>
<div class="ttc" id="expfit_8cpp_xhtml_a37ccaa07967f4b4e54f3a440b2e93932"><div class="ttname"><a href="expfit_8cpp.xhtml#a37ccaa07967f4b4e54f3a440b2e93932">lmc_exp_7_parm</a></div><div class="ttdeci">static double lmc_exp_7_parm(double x, const double *a)</div><div class="ttdoc">Compute 7 parameter exponential function value. </div><div class="ttdef"><b>Definition:</b> expfit.cpp:249</div></div>
</div><!-- fragment -->
<p>array of fitting functions corresponding to the pre-defined types </p>

</div>
</div>
<a class="anchor" id="a740d0a52199e66c0e9b00f92e894293a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* longs_ffn[effnNR]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;no fit&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = exp(-x/|a0|)&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = a1 exp(-x/|a0|)&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = a1 exp(-x/|a0|) + (1-a1) exp(-x/(|a2|)), a2 &gt; a0 &gt; 0&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = a0 exp(-x/|a1|) +  a2 exp(-x/|a3|) + a4, a3 &gt;= a1&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = a0 exp(-x/|a1|) +  a2 exp(-x/|a3|) + a4 exp(-x/|a5|) + a6, a5 &gt;= a3 &gt;= a1&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = a0 exp(-x/|a1|) +  a2 exp(-x/|a3|) + a4 exp(-x/|a5|) + a6 exp(-x/|a7|) + a8, a7 &gt;= a5 &gt;= a3 &gt;= a1&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = exp(-v) (cosh(wv) + 1/w sinh(wv)), v = x/(2 a0), w = sqrt(1 - a1)&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = 1/2*(a0+a1) - 1/2*(a0-a1)*erf( (x-a2) /a3^2)&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = a1 *2*a0*((exp(-x/a0)-1)*(a0/x)+1)+(1-a1)*2*a2*((exp(-x/a2)-1)*(a2/x)+1)&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;y = (1-a0)*cos(x*a1)*exp(-(x/a2)^a3) + a0*exp(-(x/a4)^a5)&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Long description for each fitting function type. </p>

</div>
</div>
<a class="anchor" id="a8c5348612f872710564767a5d1a0332e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* s_ffn[effnNR+2]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;none&quot;</span>, <span class="stringliteral">&quot;exp&quot;</span>, <span class="stringliteral">&quot;aexp&quot;</span>, <span class="stringliteral">&quot;exp_exp&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;exp5&quot;</span>, <span class="stringliteral">&quot;exp7&quot;</span>, <span class="stringliteral">&quot;exp9&quot;</span>,</div>
<div class="line">    <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span></div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Short name of each function type. This is exported for now in order to use when calling parse_common_args. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Aug 23 2018 14:57:16 for Gromacs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
