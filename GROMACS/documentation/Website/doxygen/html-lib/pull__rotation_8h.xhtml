<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Gromacs: src/gromacs/pulling/pull_rotation.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Gromacs
   &#160;<span id="projectnumber">2018.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.xhtml"><span>Modules</span></a></li>
      <li><a href="pages.xhtml"><span>Other&#160;Docs</span></a></li>
      <li><a href="namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="annotated.xhtml"><span>Classes</span></a></li>
      <li class="current"><a href="files.xhtml"><span>Files</span></a></li>
      <li><a href="examples.xhtml"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.xhtml"><span>File&#160;List</span></a></li>
      <li><a href="globals.xhtml"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8a21c46af9718d1f610eb513153099d7.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_a46192700e9e8ed44c648f0a55ee9a53.xhtml">gromacs</a></li><li class="navelem"><a class="el" href="dir_f0525b1fd47aeb3c14bec98caed922ee.xhtml">pulling</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pull_rotation.h File Reference<div class="ingroups"><a class="el" href="group__group__libraryapi.xhtml">Library API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;gromacs/math/vectypes.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="basedefinitions_8h.xhtml">gromacs/utility/basedefinitions.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for pull_rotation.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pull__rotation_8h__incl.svg" width="307" height="202"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>Declares functions to enforce rotational motion upon a group of particles. </p>
<dl class="section author"><dt>Author</dt><dd>Carsten Kutzner <a href="#" onclick="location.href='mai'+'lto:'+'cku'+'tz'+'ne@'+'gw'+'dg.'+'de'; return false;">ckutz<span style="display: none;">.nosp@m.</span>ne@g<span style="display: none;">.nosp@m.</span>wdg.d<span style="display: none;">.nosp@m.</span>e</a> </dd></dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad5857a35ca6a48f50b6758df4384d768"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pull__rotation_8h.xhtml#ad5857a35ca6a48f50b6758df4384d768">init_rot</a> (FILE *fplog, t_inputrec *ir, int nfile, const <a class="el" href="structt__filenm.xhtml">t_filenm</a> fnm[], struct t_commrec *cr, const <a class="el" href="classt__state.xhtml">t_state</a> *globalState, gmx_mtop_t *mtop, const gmx_output_env_t *oenv, const MdrunOptions &amp;mdrunOptions)</td></tr>
<tr class="memdesc:ad5857a35ca6a48f50b6758df4384d768"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the enforced rotation groups.  <a href="#ad5857a35ca6a48f50b6758df4384d768">More...</a><br/></td></tr>
<tr class="separator:ad5857a35ca6a48f50b6758df4384d768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9eb625849a770e1725919553e499eaa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pull__rotation_8h.xhtml#aa9eb625849a770e1725919553e499eaa">dd_make_local_rotation_groups</a> (struct gmx_domdec_t *dd, t_rot *rot)</td></tr>
<tr class="memdesc:aa9eb625849a770e1725919553e499eaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a selection of the home atoms for all enforced rotation groups.  <a href="#aa9eb625849a770e1725919553e499eaa">More...</a><br/></td></tr>
<tr class="separator:aa9eb625849a770e1725919553e499eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31deb85c062f5e8be828850ca5660fe5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pull__rotation_8h.xhtml#a31deb85c062f5e8be828850ca5660fe5">do_rotation</a> (struct t_commrec *cr, t_inputrec *ir, matrix box, rvec x[], <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> t, gmx_int64_t step, <a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a> bNS)</td></tr>
<tr class="memdesc:a31deb85c062f5e8be828850ca5660fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the enforced rotation potential(s).  <a href="#a31deb85c062f5e8be828850ca5660fe5">More...</a><br/></td></tr>
<tr class="separator:a31deb85c062f5e8be828850ca5660fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d31df416f4acc03e22c05deedc9b57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pull__rotation_8h.xhtml#a81d31df416f4acc03e22c05deedc9b57">add_rot_forces</a> (t_rot *rot, rvec f[], struct t_commrec *cr, gmx_int64_t step, <a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> t)</td></tr>
<tr class="memdesc:a81d31df416f4acc03e22c05deedc9b57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the enforced rotation forces to the official force array.  <a href="#a81d31df416f4acc03e22c05deedc9b57">More...</a><br/></td></tr>
<tr class="separator:a81d31df416f4acc03e22c05deedc9b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81648ac40d11af9c978d10dce4f074f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pull__rotation_8h.xhtml#a81648ac40d11af9c978d10dce4f074f3">finish_rot</a> (t_rot *rot)</td></tr>
<tr class="memdesc:a81648ac40d11af9c978d10dce4f074f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the enforced rotation output files.  <a href="#a81648ac40d11af9c978d10dce4f074f3">More...</a><br/></td></tr>
<tr class="separator:a81648ac40d11af9c978d10dce4f074f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a81d31df416f4acc03e22c05deedc9b57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a> add_rot_forces </td>
          <td>(</td>
          <td class="paramtype">t_rot *&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct t_commrec *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gmx_int64_t&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the enforced rotation forces to the official force array. </p>
<p>Adds the forces from enforced rotation potential to the local forces and sums up the contributions to the rotation potential from all the nodes. Since this needs communication, this routine should be called after the short range forces have been evaluated (in order not to spoil cycle counts). This routine also outputs data to the rotation output files (e.g. the potential, the angle of the group(s), and torques).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rot</td><td>Pointer to all the enforced rotation data. </td></tr>
    <tr><td class="paramname">f</td><td>The local forces to which the rotational forces have to be added. </td></tr>
    <tr><td class="paramname">cr</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">step</td><td>The time step, used for output. </td></tr>
    <tr><td class="paramname">t</td><td>Time, used for output. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The potential energy of the rotation potentials. </dd></dl>

</div>
</div>
<a class="anchor" id="aa9eb625849a770e1725919553e499eaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_make_local_rotation_groups </td>
          <td>(</td>
          <td class="paramtype">struct gmx_domdec_t *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">t_rot *&#160;</td>
          <td class="paramname"><em>rot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make a selection of the home atoms for all enforced rotation groups. </p>
<p>This routine is similar to <a class="el" href="pull_8h.xhtml#a3c0994758d27eec2e24551de9c7b6808">dd_make_local_pull_groups</a>, but works only with domain decomposition. It should be called at every domain decomposition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dd</td><td>Structure containing domain decomposition data. </td></tr>
    <tr><td class="paramname">rot</td><td>Pointer to all the enforced rotation data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a31deb85c062f5e8be828850ca5660fe5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void do_rotation </td>
          <td>(</td>
          <td class="paramtype">struct t_commrec *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">t_inputrec *&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">matrix&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rvec&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="real_8h.xhtml#a58a0c7cf2501f4492da833421be92547">real</a>&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gmx_int64_t&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="basedefinitions_8h.xhtml#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bNS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the enforced rotation potential(s). </p>
<p>This is the main enforced rotation module which is called during every time step. Here the rotation potential as well as the resulting forces are calculated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cr</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">ir</td><td>Struct containing MD input parameters, among those </td></tr>
    <tr><td class="paramname">box</td><td>Simulation box, needed to make group whole. </td></tr>
    <tr><td class="paramname">x</td><td>The positions of all the local particles. </td></tr>
    <tr><td class="paramname">t</td><td>Time. </td></tr>
    <tr><td class="paramname">step</td><td>The time step. </td></tr>
    <tr><td class="paramname">bNS</td><td>After domain decomposition / neighbor searching several local arrays have to be updated (masses, shifts) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a81648ac40d11af9c978d10dce4f074f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void finish_rot </td>
          <td>(</td>
          <td class="paramtype">t_rot *&#160;</td>
          <td class="paramname"><em>rot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the enforced rotation output files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rot</td><td>Pointer to all the enforced rotation data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad5857a35ca6a48f50b6758df4384d768"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_rot </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fplog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">t_inputrec *&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structt__filenm.xhtml">t_filenm</a>&#160;</td>
          <td class="paramname"><em>fnm</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct t_commrec *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classt__state.xhtml">t_state</a> *&#160;</td>
          <td class="paramname"><em>globalState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gmx_mtop_t *&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gmx_output_env_t *&#160;</td>
          <td class="paramname"><em>oenv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MdrunOptions &amp;&#160;</td>
          <td class="paramname"><em>mdrunOptions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the enforced rotation groups. </p>
<p>This routine does the memory allocation for various helper arrays, opens the output files etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fplog</td><td>General output file, normally md.log. </td></tr>
    <tr><td class="paramname">ir</td><td>Struct containing MD input parameters, among those also the enforced rotation parameters. </td></tr>
    <tr><td class="paramname">nfile</td><td>Number of entries in the fnm structure. </td></tr>
    <tr><td class="paramname">fnm</td><td>The filenames struct containing also the names of the rotation output files. </td></tr>
    <tr><td class="paramname">cr</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">globalState</td><td>The global state, only used on the master rank. </td></tr>
    <tr><td class="paramname">mtop</td><td>Molecular topology. </td></tr>
    <tr><td class="paramname">oenv</td><td>Needed to open the rotation output xvgr file. </td></tr>
    <tr><td class="paramname">mdrunOptions</td><td>Options for mdrun. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Aug 23 2018 14:56:07 for Gromacs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
