<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.5">
  <compounddef id="gmx__omp__nthreads_8cpp" kind="file">
    <compoundname>gmx_omp_nthreads.cpp</compoundname>
    <includes refid="gmxpre_8h" local="yes">gmxpre.h</includes>
    <includes refid="gmx__omp__nthreads_8h" local="yes">gmx_omp_nthreads.h</includes>
    <includes local="yes">config.h</includes>
    <includes local="no">cstdio</includes>
    <includes local="no">cstdlib</includes>
    <includes local="no">cstring</includes>
    <includes refid="md__logging_8h" local="yes">gromacs/gmxlib/md_logging.h</includes>
    <includes refid="network_8h" local="yes">gromacs/gmxlib/network.h</includes>
    <includes refid="commrec_8h" local="yes">gromacs/mdtypes/commrec.h</includes>
    <includes refid="cstringutil_8h" local="yes">gromacs/utility/cstringutil.h</includes>
    <includes refid="fatalerror_8h" local="yes">gromacs/utility/fatalerror.h</includes>
    <includes refid="gmxassert_8h" local="yes">gromacs/utility/gmxassert.h</includes>
    <includes refid="gmxomp_8h" local="yes">gromacs/utility/gmxomp.h</includes>
    <includes refid="programcontext_8h" local="yes">gromacs/utility/programcontext.h</includes>
    <incdepgraph>
      <node id="10870">
        <label>stdarg.h</label>
      </node>
      <node id="10872">
        <label>gromacs/utility/current_function.h</label>
        <link refid="current__function_8h"/>
      </node>
      <node id="10858">
        <label>src/gromacs/mdlib/gmx_omp_nthreads.cpp</label>
        <link refid="gmx_omp_nthreads.cpp"/>
        <childnode refid="10859" relation="include">
        </childnode>
        <childnode refid="10860" relation="include">
        </childnode>
        <childnode refid="10861" relation="include">
        </childnode>
        <childnode refid="10862" relation="include">
        </childnode>
        <childnode refid="10863" relation="include">
        </childnode>
        <childnode refid="10864" relation="include">
        </childnode>
        <childnode refid="10869" relation="include">
        </childnode>
        <childnode refid="10871" relation="include">
        </childnode>
        <childnode refid="10873" relation="include">
        </childnode>
        <childnode refid="10874" relation="include">
        </childnode>
      </node>
      <node id="10869">
        <label>gromacs/utility/fatalerror.h</label>
        <link refid="fatalerror_8h"/>
        <childnode refid="10870" relation="include">
        </childnode>
        <childnode refid="10865" relation="include">
        </childnode>
        <childnode refid="10866" relation="include">
        </childnode>
      </node>
      <node id="10867">
        <label>stdint.h</label>
      </node>
      <node id="10859">
        <label>gmxpre.h</label>
        <link refid="gmxpre_8h"/>
      </node>
      <node id="10864">
        <label>gromacs/utility/cstringutil.h</label>
        <link refid="cstringutil_8h"/>
        <childnode refid="10865" relation="include">
        </childnode>
        <childnode refid="10866" relation="include">
        </childnode>
      </node>
      <node id="10874">
        <label>gromacs/utility/programcontext.h</label>
        <link refid="programcontext_8h"/>
      </node>
      <node id="10873">
        <label>gromacs/utility/gmxomp.h</label>
        <link refid="gmxomp_8h"/>
        <childnode refid="10860" relation="include">
        </childnode>
        <childnode refid="10865" relation="include">
        </childnode>
        <childnode refid="10866" relation="include">
        </childnode>
      </node>
      <node id="10861">
        <label>cstdio</label>
      </node>
      <node id="10871">
        <label>gromacs/utility/gmxassert.h</label>
        <link refid="gmxassert_8h"/>
        <childnode refid="10866" relation="include">
        </childnode>
        <childnode refid="10872" relation="include">
        </childnode>
      </node>
      <node id="10862">
        <label>cstdlib</label>
      </node>
      <node id="10866">
        <label>gromacs/utility/basedefinitions.h</label>
        <link refid="basedefinitions_8h"/>
        <childnode refid="10867" relation="include">
        </childnode>
        <childnode refid="10868" relation="include">
        </childnode>
      </node>
      <node id="10860">
        <label>config.h</label>
      </node>
      <node id="10865">
        <label>stdio.h</label>
      </node>
      <node id="10863">
        <label>cstring</label>
      </node>
      <node id="10868">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structomp__module__nthreads__t" prot="public">omp_module_nthreads_t</innerclass>
      <sectiondef kind="var">
      <memberdef kind="variable" id="gmx__omp__nthreads_8cpp_1a796f8595e8e4abb558f9a0a175654ece" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* modth_env_var[emntNR]</definition>
        <argsstring>[emntNR]</argsstring>
        <name>modth_env_var</name>
        <initializer>=
{
    &quot;GMX_DEFAULT_NUM_THREADS should never be <ref refid="parser__internal_8h_1a8553aeb4ef79ad62e90241cf54e221d5" kindref="member">set</ref>&quot;,
    &quot;GMX_DOMDEC_NUM_THREADS&quot;, &quot;GMX_PAIRSEARCH_NUM_THREADS&quot;,
    &quot;GMX_NONBONDED_NUM_THREADS&quot;, &quot;GMX_LISTED_FORCES_NUM_THREADS&quot;,
    &quot;GMX_PME_NUM_THREADS&quot;, &quot;GMX_UPDATE_NUM_THREADS&quot;,
    &quot;GMX_VSITE_NUM_THREADS&quot;,
    &quot;GMX_LINCS_NUM_THREADS&quot;, &quot;GMX_SETTLE_NUM_THREADS&quot;
}</initializer>
        <briefdescription>
<para>Names of environment variables to set the per module number of threads. </para>        </briefdescription>
        <detaileddescription>
<para>Indexed with the values of module_nth_t. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="70" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="70" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gmx__omp__nthreads_8cpp_1a6b8ebb60dea625e3362ec8faba1cf8e0" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* mod_name[emntNR]</definition>
        <argsstring>[emntNR]</argsstring>
        <name>mod_name</name>
        <initializer>=
{
    &quot;default&quot;, &quot;domain decomposition&quot;, &quot;pair search&quot;, &quot;non-bonded&quot;,
    &quot;bonded&quot;, &quot;PME&quot;, &quot;update&quot;, &quot;LINCS&quot;, &quot;SETTLE&quot;
}</initializer>
        <briefdescription>
<para>Names of the modules. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="81" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="81" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gmx__omp__nthreads_8cpp_1a50e637fc24b5b017d7a0bff2128cfad4" prot="public" static="yes" mutable="no">
        <type><ref refid="structomp__module__nthreads__t" kindref="compound">omp_module_nthreads_t</ref></type>
        <definition>omp_module_nthreads_t modth</definition>
        <argsstring></argsstring>
        <name>modth</name>
        <initializer>= { 0, 0, {0, 0, 0, 0, 0, 0, 0, 0, 0},  0 }</initializer>
        <briefdescription>
<para>Number of threads for each algorithmic module. </para>        </briefdescription>
        <detaileddescription>
<para>File-scope global variable that gets set once in pick_module_nthreads() and queried via gmx_omp_nthreads_get().</para><para>All fields are initialized to 0 which should result in errors if the init call is omitted. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="95" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="95" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1a008e619f811ec9b19501019d4fd6d765" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void pick_module_nthreads</definition>
        <argsstring>(FILE *fplog, int m, gmx_bool bSimMaster, gmx_bool bFullOmpSupport, gmx_bool bSepPME)</argsstring>
        <name>pick_module_nthreads</name>
        <param>
          <type>FILE *</type>
          <declname>fplog</declname>
        </param>
        <param>
          <type>int</type>
          <declname>m</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bSimMaster</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bFullOmpSupport</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bSepPME</declname>
        </param>
        <briefdescription>
<para>Determine the number of threads for module <computeroutput>mod</computeroutput>. </para>        </briefdescription>
        <detaileddescription>
<para><computeroutput>m</computeroutput> takes values form the module_nth_t enum and maps these to the corresponding value in modth_env_var.</para><para>Each number of threads per module takes the default value unless GMX_*_NUM_THERADS env var is set, case in which its value overrides the deafult.</para><para>The &quot;group&quot; scheme supports OpenMP only in PME and in thise case all but the PME nthread values default to 1. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="110" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="110" bodyend="184"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1abfa4a294f3267151d4c6b887cd59efba" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gmx_omp_nthreads_read_env</definition>
        <argsstring>(int *nthreads_omp, gmx_bool bIsSimMaster)</argsstring>
        <name>gmx_omp_nthreads_read_env</name>
        <param>
          <type>int *</type>
          <declname>nthreads_omp</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bIsSimMaster</declname>
        </param>
        <briefdescription>
<para>Read the OMP_NUM_THREADS env. var. and check against the value set on the command line. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="186" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="186" bodyend="233"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1aed758d505e73bc5bc2148cd867b3a3b1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void manage_number_of_openmp_threads</definition>
        <argsstring>(FILE *fplog, const t_commrec *cr, bool bOMP, int nthreads_hw_avail, int omp_nthreads_req, int omp_nthreads_pme_req, gmx_bool bThisNodePMEOnly, gmx_bool bFullOmpSupport, int nppn, gmx_bool bSepPME)</argsstring>
        <name>manage_number_of_openmp_threads</name>
        <param>
          <type>FILE *</type>
          <declname>fplog</declname>
        </param>
        <param>
          <type>const <ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>bOMP</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nthreads_hw_avail</declname>
        </param>
        <param>
          <type>int</type>
          <declname>omp_nthreads_req</declname>
        </param>
        <param>
          <type>int</type>
          <declname>omp_nthreads_pme_req</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bThisNodePMEOnly</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bFullOmpSupport</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nppn</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bSepPME</declname>
        </param>
        <briefdescription>
<para>Helper function for parsing various input about the number of OpenMP threads to use in various modules and deciding what to do about it. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="238" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="238" bodyend="388"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1a7a2f8d33271a5c997dbf66eecd24c0d0" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void reportOpenmpSettings</definition>
        <argsstring>(FILE *fplog, const t_commrec *cr, gmx_bool bOMP, gmx_bool bFullOmpSupport, gmx_bool bSepPME)</argsstring>
        <name>reportOpenmpSettings</name>
        <param>
          <type>FILE *</type>
          <declname>fplog</declname>
        </param>
        <param>
          <type>const <ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bOMP</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bFullOmpSupport</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bSepPME</declname>
        </param>
        <briefdescription>
<para>Report on the OpenMP settings that will be used. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="392" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="392" bodyend="468"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1a085c606e363ac2e253df095a8989a730" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void issueOversubscriptionWarning</definition>
        <argsstring>(FILE *fplog, const t_commrec *cr, int nthreads_hw_avail, int nppn, gmx_bool bSepPME)</argsstring>
        <name>issueOversubscriptionWarning</name>
        <param>
          <type>FILE *</type>
          <declname>fplog</declname>
        </param>
        <param>
          <type>const <ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nthreads_hw_avail</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nppn</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bSepPME</declname>
        </param>
        <briefdescription>
<para>Detect and warn about oversubscription of cores. </para>        </briefdescription>
        <detaileddescription>
<para><xrefsect id="todo_1_todo000023"><xreftitle>Todo</xreftitle><xrefdescription><para>This could probably live elsewhere, since it is not specifc to OpenMP, and only needs modth.gnth.</para></xrefdescription></xrefsect></para><para><xrefsect id="todo_1_todo000024"><xreftitle>Todo</xreftitle><xrefdescription><para>Enable this for separate PME nodes as well! </para></xrefdescription></xrefsect></para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="477" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="477" bodyend="512"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1ad4fb77d86b3b8389c21e64a22c275df2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gmx_omp_nthreads_init</definition>
        <argsstring>(FILE *fplog, t_commrec *cr, int nthreads_hw_avail, int omp_nthreads_req, int omp_nthreads_pme_req, gmx_bool bThisNodePMEOnly, gmx_bool bFullOmpSupport)</argsstring>
        <name>gmx_omp_nthreads_init</name>
        <param>
          <type>FILE *</type>
          <declname>fplog</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nthreads_hw_avail</declname>
        </param>
        <param>
          <type>int</type>
          <declname>omp_nthreads_req</declname>
        </param>
        <param>
          <type>int</type>
          <declname>omp_nthreads_pme_req</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bCurrNodePMEOnly</declname>
          <defname>bThisNodePMEOnly</defname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bFullOmpSupport</declname>
        </param>
        <briefdescription>
<para>Initializes the per-module thread count. </para>        </briefdescription>
        <detaileddescription>
<para>It is compatible with tMPI, thread-safety is ensured (for the features available with tMPI). This function should caled only once during the initialization of mdrun. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="514" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="514" bodyend="549"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1a99736c95bb0878532f019dbe195ac5cb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int gmx_omp_nthreads_get</definition>
        <argsstring>(int mod)</argsstring>
        <name>gmx_omp_nthreads_get</name>
        <param>
          <type>int</type>
          <declname>mod</declname>
        </param>
        <briefdescription>
<para>Returns the number of threads to be used in the given module <computeroutput>mod</computeroutput>. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="551" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="551" bodyend="562"/>
      </memberdef>
      <memberdef kind="function" id="gmx__omp__nthreads_8cpp_1a22b5cfe7e5666d6d558cae83df24b3f7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gmx_omp_nthreads_set</definition>
        <argsstring>(int mod, int nthreads)</argsstring>
        <name>gmx_omp_nthreads_set</name>
        <param>
          <type>int</type>
          <declname>mod</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nthreads</declname>
        </param>
        <briefdescription>
<para>Sets the number of threads to be used in module. </para>        </briefdescription>
        <detaileddescription>
<para>Intended for use in testing. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" line="565" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp" bodystart="565" bodyend="572"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/mdlib/gmx_omp_nthreads.cpp"/>
  </compounddef>
</doxygen>
