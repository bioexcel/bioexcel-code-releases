<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.5">
  <compounddef id="gromacs_2swap_2swapcoords_8cpp" kind="file">
    <compoundname>swapcoords.cpp</compoundname>
    <includes refid="gmxpre_8h" local="yes">gmxpre.h</includes>
    <includes refid="swapcoords_8h" local="yes">swapcoords.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">time.h</includes>
    <includes local="no">string</includes>
    <includes refid="domdec__struct_8h" local="yes">gromacs/domdec/domdec_struct.h</includes>
    <includes refid="confio_8h" local="yes">gromacs/fileio/confio.h</includes>
    <includes refid="gmxfio_8h" local="yes">gromacs/fileio/gmxfio.h</includes>
    <includes refid="xvgr_8h" local="yes">gromacs/fileio/xvgr.h</includes>
    <includes refid="network_8h" local="yes">gromacs/gmxlib/network.h</includes>
    <includes refid="vec_8h" local="yes">gromacs/math/vec.h</includes>
    <includes refid="groupcoord_8h" local="yes">gromacs/mdlib/groupcoord.h</includes>
    <includes refid="mdrun_8h" local="yes">gromacs/mdlib/mdrun.h</includes>
    <includes refid="sim__util_8h" local="yes">gromacs/mdlib/sim_util.h</includes>
    <includes refid="inputrec_8h" local="yes">gromacs/mdtypes/inputrec.h</includes>
    <includes refid="md__enums_8h" local="yes">gromacs/mdtypes/md_enums.h</includes>
    <includes refid="pbc_8h" local="yes">gromacs/pbcutil/pbc.h</includes>
    <includes refid="wallcycle_8h" local="yes">gromacs/timing/wallcycle.h</includes>
    <includes refid="mtop__util_8h" local="yes">gromacs/topology/mtop_util.h</includes>
    <includes refid="topology_8h" local="yes">gromacs/topology/topology.h</includes>
    <includes refid="cstringutil_8h" local="yes">gromacs/utility/cstringutil.h</includes>
    <includes refid="fatalerror_8h" local="yes">gromacs/utility/fatalerror.h</includes>
    <includes refid="pleasecite_8h" local="yes">gromacs/utility/pleasecite.h</includes>
    <includes refid="smalloc_8h" local="yes">gromacs/utility/smalloc.h</includes>
    <includes refid="snprintf_8h" local="yes">gromacs/utility/snprintf.h</includes>
    <incdepgraph>
      <node id="18852">
        <label>stdarg.h</label>
      </node>
      <node id="18855">
        <label>gromacs/utility/smalloc.h</label>
        <link refid="smalloc_8h"/>
        <childnode refid="18856" relation="include">
        </childnode>
        <childnode refid="18842" relation="include">
        </childnode>
      </node>
      <node id="18851">
        <label>gromacs/utility/fatalerror.h</label>
        <link refid="fatalerror_8h"/>
        <childnode refid="18852" relation="include">
        </childnode>
        <childnode refid="18836" relation="include">
        </childnode>
        <childnode refid="18842" relation="include">
        </childnode>
      </node>
      <node id="18843">
        <label>stdint.h</label>
      </node>
      <node id="18837">
        <label>stdlib.h</label>
      </node>
      <node id="18833">
        <label>src/gromacs/swap/swapcoords.cpp</label>
        <link refid="gromacs/swap/swapcoords.cpp"/>
        <childnode refid="18834" relation="include">
        </childnode>
        <childnode refid="18835" relation="include">
        </childnode>
        <childnode refid="18836" relation="include">
        </childnode>
        <childnode refid="18837" relation="include">
        </childnode>
        <childnode refid="18838" relation="include">
        </childnode>
        <childnode refid="18839" relation="include">
        </childnode>
        <childnode refid="18840" relation="include">
        </childnode>
        <childnode refid="18848" relation="include">
        </childnode>
        <childnode refid="18849" relation="include">
        </childnode>
        <childnode refid="18850" relation="include">
        </childnode>
        <childnode refid="18851" relation="include">
        </childnode>
        <childnode refid="18853" relation="include">
        </childnode>
        <childnode refid="18855" relation="include">
        </childnode>
        <childnode refid="18857" relation="include">
        </childnode>
      </node>
      <node id="18834">
        <label>gmxpre.h</label>
        <link refid="gmxpre_8h"/>
      </node>
      <node id="18850">
        <label>gromacs/utility/cstringutil.h</label>
        <link refid="cstringutil_8h"/>
        <childnode refid="18836" relation="include">
        </childnode>
        <childnode refid="18842" relation="include">
        </childnode>
      </node>
      <node id="18839">
        <label>string</label>
      </node>
      <node id="18840">
        <label>gromacs/domdec/domdec_struct.h</label>
        <link refid="domdec__struct_8h"/>
        <childnode refid="18841" relation="include">
        </childnode>
        <childnode refid="18842" relation="include">
        </childnode>
        <childnode refid="18845" relation="include">
        </childnode>
        <childnode refid="18847" relation="include">
        </childnode>
      </node>
      <node id="18856">
        <label>stddef.h</label>
      </node>
      <node id="18835">
        <label>swapcoords.h</label>
        <link refid="swapcoords_8h"/>
      </node>
      <node id="18847">
        <label>gromacs/utility/real.h</label>
        <link refid="real_8h"/>
      </node>
      <node id="18848">
        <label>gromacs/mdlib/groupcoord.h</label>
        <link refid="groupcoord_8h"/>
        <childnode refid="18836" relation="include">
        </childnode>
        <childnode refid="18842" relation="include">
        </childnode>
      </node>
      <node id="18854">
        <label>cstdio</label>
      </node>
      <node id="18857">
        <label>gromacs/utility/snprintf.h</label>
        <link refid="snprintf_8h"/>
        <childnode refid="18846" relation="include">
        </childnode>
        <childnode refid="18836" relation="include">
        </childnode>
      </node>
      <node id="18838">
        <label>time.h</label>
      </node>
      <node id="18841">
        <label>cstddef</label>
      </node>
      <node id="18849">
        <label>gromacs/mdtypes/md_enums.h</label>
        <link refid="md__enums_8h"/>
        <childnode refid="18842" relation="include">
        </childnode>
      </node>
      <node id="18842">
        <label>gromacs/utility/basedefinitions.h</label>
        <link refid="basedefinitions_8h"/>
        <childnode refid="18843" relation="include">
        </childnode>
        <childnode refid="18844" relation="include">
        </childnode>
      </node>
      <node id="18846">
        <label>config.h</label>
      </node>
      <node id="18853">
        <label>gromacs/utility/pleasecite.h</label>
        <link refid="pleasecite_8h"/>
        <childnode refid="18854" relation="include">
        </childnode>
      </node>
      <node id="18845">
        <label>gromacs/utility/gmxmpi.h</label>
        <link refid="gmxmpi_8h"/>
        <childnode refid="18846" relation="include">
        </childnode>
      </node>
      <node id="18836">
        <label>stdio.h</label>
      </node>
      <node id="18844">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structswap__compartment" prot="public">swap_compartment</innerclass>
    <innerclass refid="structswap__group" prot="public">swap_group</innerclass>
    <innerclass refid="structt__swap" prot="public">t_swap</innerclass>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="gromacs_2swap_2swapcoords_8cpp_1af6a8c133d0f81c73038956aac7684e18" prot="public" static="no">
        <name>eChannelHistory</name>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1af6a8c133d0f81c73038956aac7684e18a9a70d7d49d984385d4ebac21d870adc0" prot="public">
          <name>eChHistPassedNone</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1af6a8c133d0f81c73038956aac7684e18a5443d9f639e191ef34eeaf7cec960ee3" prot="public">
          <name>eChHistPassedCh0</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1af6a8c133d0f81c73038956aac7684e18a501e766ba5a939d3f83f5d914121020d" prot="public">
          <name>eChHistPassedCh1</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1af6a8c133d0f81c73038956aac7684e18aede32915580b4607786ca1d83f7f7084" prot="public">
          <name>eChHistNr</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Keep track of through which channel the ions have passed. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="80" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="80" bodyend="82"/>
      </memberdef>
      <memberdef kind="enum" id="gromacs_2swap_2swapcoords_8cpp_1a94f95f058c9d43880125a4c12bc455c1" prot="public" static="no">
        <name>eDomain</name>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1a94f95f058c9d43880125a4c12bc455c1a5e7dca1ed7bcfdedaea4e7003a1ecfbc" prot="public">
          <name>eDomainNotset</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1a94f95f058c9d43880125a4c12bc455c1a983de9218b59827b7b5ea71a18f5245a" prot="public">
          <name>eDomainA</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1a94f95f058c9d43880125a4c12bc455c1afbd290e0077e8e3594fef767a2551e29" prot="public">
          <name>eDomainB</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gromacs_2swap_2swapcoords_8cpp_1a94f95f058c9d43880125a4c12bc455c1abdc14dc97257c87707198a782f7a4b25" prot="public">
          <name>eDomainNr</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Domain identifier. </para>        </briefdescription>
        <detaileddescription>
<para>Keeps track of from which compartment the ions came before passing the channel. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="90" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="90" bodyend="92"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="gromacs_2swap_2swapcoords_8cpp_1a05ce22240f64704f05ccebe070bf44ee" prot="public" static="no">
        <type>struct <ref refid="structswap__compartment" kindref="compound">swap_compartment</ref></type>
        <definition>typedef struct swap_compartment  t_compartment</definition>
        <argsstring></argsstring>
        <name>t_compartment</name>
        <briefdescription>
<para>Structure containing compartment-specific data. </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="114" column="1"/>
      </memberdef>
      <memberdef kind="typedef" id="gromacs_2swap_2swapcoords_8cpp_1a7aaf7894f28f10cff8666e54ce75fa98" prot="public" static="no">
        <type>struct <ref refid="structswap__group" kindref="compound">swap_group</ref></type>
        <definition>typedef struct swap_group  t_swapgrp</definition>
        <argsstring></argsstring>
        <name>t_swapgrp</name>
        <briefdescription>
<para>This structure contains data needed for the groups involved in swapping: split group 0, split group 1, solvent group, ion groups. </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="152" column="1"/>
      </memberdef>
      <memberdef kind="typedef" id="gromacs_2swap_2swapcoords_8cpp_1a09aa2672d14b668ffdabd163b87fb0b6" prot="public" static="no">
        <type>struct <ref refid="structt__swap" kindref="compound">t_swap</ref></type>
        <definition>typedef struct t_swap  t_swap</definition>
        <argsstring></argsstring>
        <name>t_swap</name>
        <briefdescription>
<para>Main (private) data structure for the position swapping protocol. </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="167" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1a639d8486c076777c4d005071838060e3" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* SwS</definition>
        <argsstring></argsstring>
        <name>SwS</name>
        <initializer>= {&quot;SWAP:&quot;}</initializer>
        <briefdescription>
<para>For output that comes from the swap module. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="73" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="73" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1acb74003dd41d61ceb42c2359ee7e2c6a" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* SwSEmpty</definition>
        <argsstring></argsstring>
        <name>SwSEmpty</name>
        <initializer>= {&quot;     &quot;}</initializer>
        <briefdescription>
<para>Placeholder for multi-line output. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="74" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="74" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1a9075e09a33582fe302041d3b54af2708" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* CompStr[eCompNR]</definition>
        <argsstring>[eCompNR]</argsstring>
        <name>CompStr</name>
        <initializer>= {&quot;A&quot;, &quot;B&quot; }</initializer>
        <briefdescription>
<para>Compartment name. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="75" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="75" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1a69de0fe539172a552c8219176baf1fe6" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* SwapStr[eSwapTypesNR+1]</definition>
        <argsstring>[eSwapTypesNR+1]</argsstring>
        <name>SwapStr</name>
        <initializer>= { &quot;&quot;, &quot;X-&quot;, &quot;Y-&quot;, &quot;Z-&quot;, NULL}</initializer>
        <briefdescription>
<para>Name for the swap types. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="76" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="76" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1a8b5e747d5b3477ad051038126dc994cf" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* DimStr[3+1]</definition>
        <argsstring>[3+1]</argsstring>
        <name>DimStr</name>
        <initializer>= { &quot;X&quot;, &quot;Y&quot;, &quot;Z&quot;, NULL}</initializer>
        <briefdescription>
<para>Name for the swap dimension. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="77" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="77" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1a8e8d833597872131d18657d05483119c" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* ChannelString[eChHistNr]</definition>
        <argsstring>[eChHistNr]</argsstring>
        <name>ChannelString</name>
        <initializer>= { &quot;none&quot;, &quot;channel0&quot;, &quot;channel1&quot; }</initializer>
        <briefdescription>
<para>Name for the channels. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="83" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="83" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="gromacs_2swap_2swapcoords_8cpp_1ad1b319dc9c206d8c20cc8621ec21707c" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* DomainString[eDomainNr]</definition>
        <argsstring>[eDomainNr]</argsstring>
        <name>DomainString</name>
        <initializer>= { &quot;not_assigned&quot;, &quot;Domain_A&quot;, &quot;Domain_B&quot; }</initializer>
        <briefdescription>
<para>Name for the domains. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="93" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="93" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a77b6a402d1008df6dab97e39aae8c25e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
        <definition>static gmx_bool is_in_channel</definition>
        <argsstring>(rvec point, rvec center, real d_up, real d_down, real r_cyl2, t_pbc *pbc, int normal)</argsstring>
        <name>is_in_channel</name>
        <param>
          <type>rvec</type>
          <declname>point</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>center</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>d_up</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>d_down</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>r_cyl2</declname>
        </param>
        <param>
          <type><ref refid="structt__pbc" kindref="compound">t_pbc</ref> *</type>
          <declname>pbc</declname>
        </param>
        <param>
          <type>int</type>
          <declname>normal</declname>
        </param>
        <briefdescription>
<para>Check whether point is in channel. </para>        </briefdescription>
        <detaileddescription>
<para>A channel is a cylinder defined by a disc with radius r around its center c. The thickness of the cylinder is d_up - d_down.</para><para><programlisting><codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>^<sp/><sp/>d_up</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/>r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/>&lt;---------c---------&gt;</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v<sp/><sp/>d_down</highlight></codeline>
<codeline><highlight class="normal">*</highlight></codeline>
<codeline><highlight class="normal">*<sp/></highlight></codeline>
</programlisting></para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">point</parametername>
</parameternamelist>
<parameterdescription>
<para>The position (xyz) under consideration. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">center</parametername>
</parameternamelist>
<parameterdescription>
<para>The center of the cylinder. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">d_up</parametername>
</parameternamelist>
<parameterdescription>
<para>The upper extension of the cylinder. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">d_down</parametername>
</parameternamelist>
<parameterdescription>
<para>The lower extension. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">r_cyl2</parametername>
</parameternamelist>
<parameterdescription>
<para>Cylinder radius squared. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">pbc</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure with info about periodic boundary conditions. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">normal</parametername>
</parameternamelist>
<parameterdescription>
<para>The membrane normal direction is typically 3, i.e. z, but can be x or y also.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Whether the point is inside the defined cylindric channel. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="197" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="197" bodyend="230"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a728828849bec81a194e577fe23be9e5f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void print_ionlist</definition>
        <argsstring>(t_swap *s, double time, const char comment[])</argsstring>
        <name>print_ionlist</name>
        <param>
          <type><ref refid="structt__swap" kindref="compound">t_swap</ref> *</type>
          <declname>s</declname>
        </param>
        <param>
          <type>double</type>
          <declname>time</declname>
        </param>
        <param>
          <type>const char</type>
          <declname>comment</declname>
          <array>[]</array>
        </param>
        <briefdescription>
<para>Prints output to CompEL output file. </para>        </briefdescription>
        <detaileddescription>
<para>Prints to swap output file how many ions are in each compartment, where the centers of the split groups are, and how many ions of each type passed the channels. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="239" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="239" bodyend="278"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a5ec9f81c81cb13e117b321e300a4e7a8" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void get_molecule_center</definition>
        <argsstring>(rvec x[], int nat, real *weights, rvec center, t_pbc *pbc)</argsstring>
        <name>get_molecule_center</name>
        <param>
          <type>rvec</type>
          <declname>x</declname>
          <array>[]</array>
        </param>
        <param>
          <type>int</type>
          <declname>nat</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref> *</type>
          <declname>weights</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>center</declname>
        </param>
        <param>
          <type><ref refid="structt__pbc" kindref="compound">t_pbc</ref> *</type>
          <declname>pbc</declname>
        </param>
        <briefdescription>
<para>Get the center of a group of nat atoms. </para>        </briefdescription>
        <detaileddescription>
<para>Since with PBC an atom group might not be whole, use the first atom as the reference atom and determine the center with respect to this reference. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="286" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="286" bodyend="332"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1ab50897b444c6ce3f4547edc7dfdc16dd" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
        <definition>static gmx_bool compartment_contains_atom</definition>
        <argsstring>(real w1, real w2, real x, real l, real bulkOffset, real *distance_from_b)</argsstring>
        <name>compartment_contains_atom</name>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>w1</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>w2</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>x</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>l</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>bulkOffset</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref> *</type>
          <declname>distance_from_b</declname>
        </param>
        <briefdescription>
<para>Return TRUE if position x of ion (or water) is found in the compartment, i.e. between w1 and w2. </para>        </briefdescription>
        <detaileddescription>
<para>One can define and additional offset &quot;b&quot; if one wants to exchange ions/water to or from a plane not directly in the middle of w1 and w2. The offset can be in ]-1.0, ..., +1.0 [. A bulkOffset of 0.0 means &apos;no offset&apos;, so the swap-layer is directly in the middle between w1 and w2. Offsets -1.0 &lt; b &lt; 0.0 will yield swaps nearer to w1, whereas offsets 0.0 &lt; 0 &lt; +1.0 will yield swaps nearer to w2.</para><para><programlisting><codeline><highlight class="normal">*</highlight></codeline>
<codeline><highlight class="normal">*<sp/>||--------------+-------------|-------------+------------------------||</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w1<sp/><sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/>?<sp/><sp/><sp/>w2</highlight></codeline>
<codeline><highlight class="normal">*<sp/>||--------------+-------------|----b--------+------------------------||</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+1</highlight></codeline>
<codeline><highlight class="normal">*</highlight></codeline>
<codeline><highlight class="normal">*<sp/></highlight></codeline>
</programlisting></para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">w1</parametername>
</parameternamelist>
<parameterdescription>
<para>Position of &apos;wall&apos; atom 1. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">w2</parametername>
</parameternamelist>
<parameterdescription>
<para>Position of &apos;wall&apos; atom 2. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">x</parametername>
</parameternamelist>
<parameterdescription>
<para>Position of the ion or the water molecule under consideration. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">l</parametername>
</parameternamelist>
<parameterdescription>
<para>Length of the box, from || to || in the sketch. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">bulkOffset</parametername>
</parameternamelist>
<parameterdescription>
<para>Where is the bulk layer &quot;b&quot; to be found between w1 and w2? </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">distance_from_b</parametername>
</parameternamelist>
<parameterdescription>
<para>Distance of x to the bulk layer &quot;b&quot;.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>TRUE if x is between w1 and w2.</para></simplesect>
Also computes the distance of x to the compartment center (the layer that is normally situated in the middle of w1 and w2 that would be considered as having the bulk concentration of ions). </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="368" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="368" bodyend="409"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1ad7a1b35cf62cd5eb026fba9811a668bb" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void update_time_window</definition>
        <argsstring>(t_compartment *comp, int values, int replace)</argsstring>
        <name>update_time_window</name>
        <param>
          <type><ref refid="gromacs_2swap_2swapcoords_8cpp_1a05ce22240f64704f05ccebe070bf44ee" kindref="member">t_compartment</ref> *</type>
          <declname>comp</declname>
        </param>
        <param>
          <type>int</type>
          <declname>values</declname>
        </param>
        <param>
          <type>int</type>
          <declname>replace</declname>
        </param>
        <briefdescription>
<para>Updates the time-averaged number of ions in a compartment. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="413" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="413" bodyend="433"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a1558b848400a73b04408c8de03bc9f9a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void add_to_list</definition>
        <argsstring>(int ci, t_compartment *comp, real distance)</argsstring>
        <name>add_to_list</name>
        <param>
          <type>int</type>
          <declname>ci</declname>
        </param>
        <param>
          <type><ref refid="gromacs_2swap_2swapcoords_8cpp_1a05ce22240f64704f05ccebe070bf44ee" kindref="member">t_compartment</ref> *</type>
          <declname>comp</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>distance</declname>
        </param>
        <briefdescription>
<para>Add the atom with collective index ci to the atom list in compartment &apos;comp&apos;. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">ci</parametername>
</parameternamelist>
<parameterdescription>
<para>Index of this ion in the collective xc array. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="inout">comp</parametername>
</parameternamelist>
<parameterdescription>
<para>Compartment to add this atom to. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">distance</parametername>
</parameternamelist>
<parameterdescription>
<para>Shortest distance of this atom to the bulk layer, from which ion/water pairs are selected for swapping. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="443" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="443" bodyend="459"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a5f6885b6ef745b08af1d62710db7e348" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void get_compartment_boundaries</definition>
        <argsstring>(int c, t_swap *s, matrix box, real *left, real *right)</argsstring>
        <name>get_compartment_boundaries</name>
        <param>
          <type>int</type>
          <declname>c</declname>
        </param>
        <param>
          <type><ref refid="structt__swap" kindref="compound">t_swap</ref> *</type>
          <declname>s</declname>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref> *</type>
          <declname>left</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref> *</type>
          <declname>right</declname>
        </param>
        <briefdescription>
<para>Determine the compartment boundaries from the channel centers. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="463" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="463" bodyend="502"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a39159c663b728af4d12876e5eb2a9c49" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void detect_flux_per_channel</definition>
        <argsstring>(t_swapgrp *g, int iAtom, int comp, rvec atomPosition, unsigned char *comp_now, unsigned char *comp_from, unsigned char *channel_label, t_swapcoords *sc, real cyl0_r2, real cyl1_r2, gmx_int64_t step, gmx_bool bRerun, FILE *fpout)</argsstring>
        <name>detect_flux_per_channel</name>
        <param>
          <type><ref refid="gromacs_2swap_2swapcoords_8cpp_1a7aaf7894f28f10cff8666e54ce75fa98" kindref="member">t_swapgrp</ref> *</type>
          <declname>g</declname>
        </param>
        <param>
          <type>int</type>
          <declname>iAtom</declname>
        </param>
        <param>
          <type>int</type>
          <declname>comp</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>atomPosition</declname>
        </param>
        <param>
          <type>unsigned char *</type>
          <declname>comp_now</declname>
        </param>
        <param>
          <type>unsigned char *</type>
          <declname>comp_from</declname>
        </param>
        <param>
          <type>unsigned char *</type>
          <declname>channel_label</declname>
        </param>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>cyl0_r2</declname>
        </param>
        <param>
          <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
          <declname>cyl1_r2</declname>
        </param>
        <param>
          <type>gmx_int64_t</type>
          <declname>step</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bRerun</declname>
        </param>
        <param>
          <type>FILE *</type>
          <declname>fpout</declname>
        </param>
        <briefdescription>
<para>Determine the per-channel ion flux. </para>        </briefdescription>
        <detaileddescription>
<para>To determine the flux through the individual channels, we remember the compartment and channel history of each ion. An ion can be either in channel0 or channel1, or in the remaining volume of compartment A or B.</para><para><programlisting><codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>+-----------------+</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>B</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>B<sp/>compartment</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>||||||||||0||||||||<sp/>bilayer<sp/>with<sp/>channel<sp/>0</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>A</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>A</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>A<sp/>compartment</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>A</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|||||1|||||||||||||<sp/>bilayer<sp/>with<sp/>channel<sp/>1</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>B</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>B<sp/>compartment</highlight></codeline>
<codeline><highlight class="normal">*<sp/><sp/><sp/><sp/>+-----------------+</highlight></codeline>
<codeline><highlight class="normal">*</highlight></codeline>
<codeline><highlight class="normal">*<sp/></highlight></codeline>
</programlisting> </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="528" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="528" bodyend="658"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a3777523dd36e1b1526564c386e77fea0" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void sortMoleculesIntoCompartments</definition>
        <argsstring>(t_swapgrp *g, t_commrec *cr, t_swapcoords *sc, matrix box, gmx_int64_t step, FILE *fpout, gmx_bool bRerun, gmx_bool bIsSolvent)</argsstring>
        <name>sortMoleculesIntoCompartments</name>
        <param>
          <type><ref refid="gromacs_2swap_2swapcoords_8cpp_1a7aaf7894f28f10cff8666e54ce75fa98" kindref="member">t_swapgrp</ref> *</type>
          <declname>g</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <param>
          <type>gmx_int64_t</type>
          <declname>step</declname>
        </param>
        <param>
          <type>FILE *</type>
          <declname>fpout</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bRerun</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bIsSolvent</declname>
        </param>
        <briefdescription>
<para>Determines which ions or solvent molecules are in compartment A and B. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="662" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="662" bodyend="760"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1adcc246c652808f5c8d88d33ceb995c69" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void get_initial_ioncounts</definition>
        <argsstring>(t_inputrec *ir, rvec x[], matrix box, t_commrec *cr, gmx_bool bRerun)</argsstring>
        <name>get_initial_ioncounts</name>
        <param>
          <type><ref refid="structt__inputrec" kindref="compound">t_inputrec</ref> *</type>
          <declname>ir</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>x</declname>
          <array>[]</array>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bRerun</declname>
        </param>
        <briefdescription>
<para>Find out how many group atoms are in the compartments initially. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="764" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="764" bodyend="836"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a4cc74ea6098a69934fb2bf9898b609e6" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void get_initial_ioncounts_from_cpt</definition>
        <argsstring>(t_inputrec *ir, swapstate_t *swapstate, t_commrec *cr, gmx_bool bVerbose)</argsstring>
        <name>get_initial_ioncounts_from_cpt</name>
        <param>
          <type><ref refid="structt__inputrec" kindref="compound">t_inputrec</ref> *</type>
          <declname>ir</declname>
        </param>
        <param>
          <type><ref refid="structswapstate__t" kindref="compound">swapstate_t</ref> *</type>
          <declname>swapstate</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bVerbose</declname>
        </param>
        <briefdescription>
<para>Copy history of ion counts from checkpoint file. </para>        </briefdescription>
        <detaileddescription>
<para>When called, the checkpoint file has already been read in. Here we copy over the values from .cpt file to the swap data structure. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="844" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="844" bodyend="895"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a787b42726a1b79c65fcfdd0cd0889ae0" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void bc_initial_concentrations</definition>
        <argsstring>(t_commrec *cr, t_swapcoords *swap)</argsstring>
        <name>bc_initial_concentrations</name>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>swap</declname>
        </param>
        <briefdescription>
<para>The master lets all others know about the initial ion counts. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="899" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="899" bodyend="921"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a32007e69dbe1fc1ea4a019806ffef227" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void check_swap_groups</definition>
        <argsstring>(t_swap *s, int nat, gmx_bool bVerbose)</argsstring>
        <name>check_swap_groups</name>
        <param>
          <type><ref refid="structt__swap" kindref="compound">t_swap</ref> *</type>
          <declname>s</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nat</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bVerbose</declname>
        </param>
        <briefdescription>
<para>Ensure that each atom belongs to at most one of the swap groups. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="925" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="925" bodyend="967"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a8ba2ccbe421683263eda1d61c166e69d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int get_group_apm_check</definition>
        <argsstring>(int igroup, t_swap *s, gmx_bool bVerbose, const gmx_mtop_atomlookup_t alook, gmx_mtop_t *mtop)</argsstring>
        <name>get_group_apm_check</name>
        <param>
          <type>int</type>
          <declname>igroup</declname>
        </param>
        <param>
          <type><ref refid="structt__swap" kindref="compound">t_swap</ref> *</type>
          <declname>s</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bVerbose</declname>
        </param>
        <param>
          <type>const <ref refid="structgmx__mtop__atomlookup" kindref="compound">gmx_mtop_atomlookup_t</ref></type>
          <declname>alook</declname>
        </param>
        <param>
          <type><ref refid="structgmx__mtop__t" kindref="compound">gmx_mtop_t</ref> *</type>
          <declname>mtop</declname>
        </param>
        <briefdescription>
<para>Get the number of atoms per molecule for this group. </para>        </briefdescription>
        <detaileddescription>
<para>Also ensure that all the molecules in this group have this number of atoms. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="974" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="974" bodyend="1010"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1af12dac66f752186580c42fa88bfc5788" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void print_ionlist_legend</definition>
        <argsstring>(t_inputrec *ir, const gmx_output_env_t *oenv)</argsstring>
        <name>print_ionlist_legend</name>
        <param>
          <type><ref refid="structt__inputrec" kindref="compound">t_inputrec</ref> *</type>
          <declname>ir</declname>
        </param>
        <param>
          <type>const <ref refid="structgmx__output__env__t" kindref="compound">gmx_output_env_t</ref> *</type>
          <declname>oenv</declname>
        </param>
        <briefdescription>
<para>Print the legend to the swap output file. </para>        </briefdescription>
        <detaileddescription>
<para>Also print the initial values of ion counts and position of split groups. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1017" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1017" bodyend="1083"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a6577174b967d612c1691ab96bfb9e8f3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void detect_flux_per_channel_init</definition>
        <argsstring>(t_commrec *cr, t_swap *s, swapstate_t *swapstate, gmx_bool bStartFromCpt)</argsstring>
        <name>detect_flux_per_channel_init</name>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type><ref refid="structt__swap" kindref="compound">t_swap</ref> *</type>
          <declname>s</declname>
        </param>
        <param>
          <type><ref refid="structswapstate__t" kindref="compound">swapstate_t</ref> *</type>
          <declname>swapstate</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bStartFromCpt</declname>
        </param>
        <briefdescription>
<para>Initialize channel ion flux detection routine. </para>        </briefdescription>
        <detaileddescription>
<para>Initialize arrays that keep track of where the ions come from and where they go. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1091" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1091" bodyend="1194"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1ae5c500928ef13884dbcca7d03753f8a1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void outputStartStructureIfWanted</definition>
        <argsstring>(gmx_mtop_t *mtop, rvec *x, int ePBC, matrix box)</argsstring>
        <name>outputStartStructureIfWanted</name>
        <param>
          <type><ref refid="structgmx__mtop__t" kindref="compound">gmx_mtop_t</ref> *</type>
          <declname>mtop</declname>
        </param>
        <param>
          <type>rvec *</type>
          <declname>x</declname>
        </param>
        <param>
          <type>int</type>
          <declname>ePBC</declname>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <briefdescription>
<para>Outputs the initial structure to PDB file for debugging reasons. </para>        </briefdescription>
        <detaileddescription>
<para>Output the starting structure so that in case of multimeric channels the user can check whether we have the correct PBC image for all atoms. If this is not correct, the ion counts per channel will be very likely wrong. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1204" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1204" bodyend="1216"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a42779d1f7bb961029be0a8a0c5527162" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void init_swapstate</definition>
        <argsstring>(swapstate_t *swapstate, t_swapcoords *sc, gmx_mtop_t *mtop, rvec x[], matrix box, int ePBC)</argsstring>
        <name>init_swapstate</name>
        <param>
          <type><ref refid="structswapstate__t" kindref="compound">swapstate_t</ref> *</type>
          <declname>swapstate</declname>
        </param>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <param>
          <type><ref refid="structgmx__mtop__t" kindref="compound">gmx_mtop_t</ref> *</type>
          <declname>mtop</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>x</declname>
          <array>[]</array>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <param>
          <type>int</type>
          <declname>ePBC</declname>
        </param>
        <briefdescription>
<para>Initialize the swapstate structure, used for checkpoint writing. </para>        </briefdescription>
        <detaileddescription>
<para>The swapstate struct stores the information we need to make the channels whole again after restarts from a checkpoint file. Here we do the following: a) If we did not start from .cpt, we prepare the struct for proper .cpt writing, b) if we did start from .cpt, we copy over the last whole structures from .cpt, c) in any case, for subsequent checkpoint writing, we set the pointers in swapstate to the x_old arrays, which contain the correct PBC representation of multimeric channels at the last time step. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1229" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1229" bodyend="1307"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a68037d4379c6380d861698bf7532d4a7" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="real_8h_1a58a0c7cf2501f4492da833421be92547" kindref="member">real</ref></type>
        <definition>static real getRequestedChargeImbalance</definition>
        <argsstring>(t_swap *s)</argsstring>
        <name>getRequestedChargeImbalance</name>
        <param>
          <type><ref refid="structt__swap" kindref="compound">t_swap</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
<para>Determine the total charge imbalance resulting from the swap groups. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1310" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1310" bodyend="1333"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a4d2817f7839ed94e085a16937d78c943" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void copyIndicesToGroup</definition>
        <argsstring>(int *indIons, int nIons, t_swapGroup *g, t_commrec *cr)</argsstring>
        <name>copyIndicesToGroup</name>
        <param>
          <type>int *</type>
          <declname>indIons</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nIons</declname>
        </param>
        <param>
          <type><ref refid="structt__swapGroup" kindref="compound">t_swapGroup</ref> *</type>
          <declname>g</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <briefdescription>
<para>Sorts anions and cations into two separate groups. </para>        </briefdescription>
        <detaileddescription>
<para>This routine should be called for the &apos;anions&apos; and &apos;cations&apos; group, of which the indices were lumped together in the older version of the code. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1341" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1341" bodyend="1369"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a8af36ab6850a7180e957205edb62f269" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void convertOldToNewGroupFormat</definition>
        <argsstring>(t_swapcoords *sc, gmx_mtop_t *mtop, gmx_bool bVerbose, t_commrec *cr)</argsstring>
        <name>convertOldToNewGroupFormat</name>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <param>
          <type><ref refid="structgmx__mtop__t" kindref="compound">gmx_mtop_t</ref> *</type>
          <declname>mtop</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bVerbose</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <briefdescription>
<para>Converts old .tpr file CompEL contents to new data layout. </para>        </briefdescription>
        <detaileddescription>
<para>If we have read an old .tpr file (tpxv &lt;= tpxv_CompElPolyatomicIonsAndMultipleIonTypes), anions and cations are stored together in group #3. In the new format we store each ion type in a separate group. The &apos;classic&apos; groups are: #0 split group 0 - OK #1 split group 1 - OK #2 solvent - OK #3 anions - contains also cations, needs to be converted #4 cations - empty before conversion </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1385" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1385" bodyend="1437"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1ae1c5e9b22b680c95fd9cce2692112ad1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
        <definition>gmx_bool bConvertFromOldTpr</definition>
        <argsstring>(t_swapcoords *sc)</argsstring>
        <name>bConvertFromOldTpr</name>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <briefdescription>
<para>Returns TRUE if we started from an old .tpr. </para>        </briefdescription>
        <detaileddescription>
<para>Then we need to re-sort anions and cations into separate groups </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1443" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1443" bodyend="1451"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a8dc97b814a68187058ed66db52ff89d3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void init_swapcoords</definition>
        <argsstring>(FILE *fplog, gmx_bool bVerbose, t_inputrec *ir, const char *fn, gmx_mtop_t *mtop, rvec x[], matrix box, swapstate_t *swapstate, t_commrec *cr, const gmx_output_env_t *oenv, unsigned long Flags)</argsstring>
        <name>init_swapcoords</name>
        <param>
          <type>FILE *</type>
          <declname>fplog</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bVerbose</declname>
        </param>
        <param>
          <type><ref refid="structt__inputrec" kindref="compound">t_inputrec</ref> *</type>
          <declname>ir</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>fn</declname>
        </param>
        <param>
          <type><ref refid="structgmx__mtop__t" kindref="compound">gmx_mtop_t</ref> *</type>
          <declname>mtop</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>x</declname>
          <array>[]</array>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <param>
          <type><ref refid="structswapstate__t" kindref="compound">swapstate_t</ref> *</type>
          <declname>swapstate</declname>
        </param>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type>const <ref refid="structgmx__output__env__t" kindref="compound">gmx_output_env_t</ref> *</type>
          <declname>oenv</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>Flags</declname>
        </param>
        <briefdescription>
<para>Initialize ion / water position swapping (&quot;Computational Electrophysiology&quot;). </para>        </briefdescription>
        <detaileddescription>
<para>This routine does the memory allocation for various helper arrays, opens the output file, sets up swap data checkpoint writing, etc.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fplog</parametername>
</parameternamelist>
<parameterdescription>
<para>General output file, normally md.log. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">bVerbose</parametername>
</parameternamelist>
<parameterdescription>
<para>Should we be quiet or verbose? </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ir</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing MD input parameters, among those also the structure needed for position swapping. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">fn</parametername>
</parameternamelist>
<parameterdescription>
<para>Output file name for swap data. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mtop</parametername>
</parameternamelist>
<parameterdescription>
<para>Molecular topology. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">x</parametername>
</parameternamelist>
<parameterdescription>
<para>The initial positions of all particles. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">box</parametername>
</parameternamelist>
<parameterdescription>
<para>The simulation box. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">swapstate</parametername>
</parameternamelist>
<parameterdescription>
<para>Swap-related data that is read from or written to checkpoint. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">cr</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to MPI communication data. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">oenv</parametername>
</parameternamelist>
<parameterdescription>
<para>Needed to open the swap output XVGR file. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">Flags</parametername>
</parameternamelist>
<parameterdescription>
<para>Flags passed over from main, used to determine whether we are doing a rerun, appending, etc. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1454" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1454" bodyend="1827"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1afdb661b9210ffab279294198a1b029f7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void finish_swapcoords</definition>
        <argsstring>(t_swapcoords *sc)</argsstring>
        <name>finish_swapcoords</name>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <briefdescription>
<para>Finalizes ion / water position swapping. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">sc</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to swap data. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1830" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1830" bodyend="1837"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1adf6e68844c12ffa9495a1fe49aafde76" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void dd_make_local_swap_groups</definition>
        <argsstring>(gmx_domdec_t *dd, t_swapcoords *sc)</argsstring>
        <name>dd_make_local_swap_groups</name>
        <param>
          <type><ref refid="structgmx__domdec__t" kindref="compound">gmx_domdec_t</ref> *</type>
          <declname>dd</declname>
        </param>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>si_pub</declname>
          <defname>sc</defname>
        </param>
        <briefdescription>
<para>Make a selection of the home atoms for the swap groups. These are the ions, the water, and the channels. This routine should be called at every domain decomposition. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">dd</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing domain decomposition data. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">si_pub</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the swap data structure. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1840" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1840" bodyend="1854"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a8a8cea4b6b6128f19c22fb2374756b83" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
        <definition>static gmx_bool need_swap</definition>
        <argsstring>(t_swapcoords *sc)</argsstring>
        <name>need_swap</name>
        <param>
          <type><ref refid="structt__swapcoords" kindref="compound">t_swapcoords</ref> *</type>
          <declname>sc</declname>
        </param>
        <briefdescription>
<para>Do we need to swap a molecule in any of the ion groups with a water molecule at this step? </para>        </briefdescription>
        <detaileddescription>
<para>From the requested and average molecule counts we determine whether a swap is needed at this time step. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1862" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1862" bodyend="1883"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1aee789cd0e8c00d7ea9bbc4ca285cb993" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int get_index_of_distant_atom</definition>
        <argsstring>(t_compartment *comp, const char molname[])</argsstring>
        <name>get_index_of_distant_atom</name>
        <param>
          <type><ref refid="gromacs_2swap_2swapcoords_8cpp_1a05ce22240f64704f05ccebe070bf44ee" kindref="member">t_compartment</ref> *</type>
          <declname>comp</declname>
        </param>
        <param>
          <type>const char</type>
          <declname>molname</declname>
          <array>[]</array>
        </param>
        <briefdescription>
<para>Return the index of an atom or molecule suitable for swapping. </para>        </briefdescription>
        <detaileddescription>
<para>Returns the index of an atom that is far off the compartment boundaries, that is near to the bulk layer to/from which the swaps take place. Other atoms of the molecule (if any) will directly follow the returned index.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">comp</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing compartment-specific data. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">molname</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the molecule.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Index of the first atom of the molecule chosen for a position exchange. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1897" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1897" bodyend="1930"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1af85436adf396ea680ef5b6707a65a6f5" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void translate_positions</definition>
        <argsstring>(rvec *x, int apm, rvec old_com, rvec new_com, t_pbc *pbc)</argsstring>
        <name>translate_positions</name>
        <param>
          <type>rvec *</type>
          <declname>x</declname>
        </param>
        <param>
          <type>int</type>
          <declname>apm</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>old_com</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>new_com</declname>
        </param>
        <param>
          <type><ref refid="structt__pbc" kindref="compound">t_pbc</ref> *</type>
          <declname>pbc</declname>
        </param>
        <briefdescription>
<para>Swaps centers of mass and makes molecule whole if broken. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1934" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1934" bodyend="1962"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1a3f3e0cb0d87a2d8c88bd9e26607eabee" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void apply_modified_positions</definition>
        <argsstring>(t_swapgrp *g, rvec x[])</argsstring>
        <name>apply_modified_positions</name>
        <param>
          <type><ref refid="gromacs_2swap_2swapcoords_8cpp_1a7aaf7894f28f10cff8666e54ce75fa98" kindref="member">t_swapgrp</ref> *</type>
          <declname>g</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>x</declname>
          <array>[]</array>
        </param>
        <briefdescription>
<para>Write back the the modified local positions from the collective array to the official positions. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1966" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1966" bodyend="1983"/>
      </memberdef>
      <memberdef kind="function" id="gromacs_2swap_2swapcoords_8cpp_1aea069b838b358f694d0bb1e19a11eed6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
        <definition>gmx_bool do_swapcoords</definition>
        <argsstring>(t_commrec *cr, gmx_int64_t step, double t, t_inputrec *ir, gmx_wallcycle_t wcycle, rvec x[], matrix box, gmx_mtop_t *mtop, gmx_bool bVerbose, gmx_bool bRerun)</argsstring>
        <name>do_swapcoords</name>
        <param>
          <type><ref refid="structt__commrec" kindref="compound">t_commrec</ref> *</type>
          <declname>cr</declname>
        </param>
        <param>
          <type>gmx_int64_t</type>
          <declname>step</declname>
        </param>
        <param>
          <type>double</type>
          <declname>t</declname>
        </param>
        <param>
          <type><ref refid="structt__inputrec" kindref="compound">t_inputrec</ref> *</type>
          <declname>ir</declname>
        </param>
        <param>
          <type><ref refid="structgmx__wallcycle" kindref="compound">gmx_wallcycle_t</ref></type>
          <declname>wcycle</declname>
        </param>
        <param>
          <type>rvec</type>
          <declname>x</declname>
          <array>[]</array>
        </param>
        <param>
          <type>matrix</type>
          <declname>box</declname>
        </param>
        <param>
          <type><ref refid="structgmx__mtop__t" kindref="compound">gmx_mtop_t</ref> *</type>
          <declname>mtop</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bVerbose</declname>
        </param>
        <param>
          <type><ref refid="basedefinitions_8h_1a8fddad319f226e856400d190198d5151" kindref="member">gmx_bool</ref></type>
          <declname>bRerun</declname>
        </param>
        <briefdescription>
<para>&quot;Computational Electrophysiology&quot; main routine within MD loop. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">cr</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to MPI communication data. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">step</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of the MD time step. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>The time. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ir</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing MD input parameters, among those also the structure needed for position swapping. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">wcycle</parametername>
</parameternamelist>
<parameterdescription>
<para>Count wallcycles of swap routines for diagnostic output. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">x</parametername>
</parameternamelist>
<parameterdescription>
<para>Positions of home particles this node owns. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">box</parametername>
</parameternamelist>
<parameterdescription>
<para>The simulation box. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mtop</parametername>
</parameternamelist>
<parameterdescription>
<para>Molecular topology. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">bVerbose</parametername>
</parameternamelist>
<parameterdescription>
<para>Should we be quiet or verbose? </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">bRerun</parametername>
</parameternamelist>
<parameterdescription>
<para>Are we doing a rerun?</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Whether at least one pair of molecules was swapped. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" line="1986" column="1" bodyfile="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp" bodystart="1986" bodyend="2168"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Implements functions in <ref refid="swapcoords_8h" kindref="compound">swapcoords.h</ref>. </para>    </briefdescription>
    <detaileddescription>
<internal><para><simplesect kind="author"><para>Carsten Kutzner <ulink url="mailto:ckutzne@gwdg.de">ckutzne@gwdg.de</ulink> </para></simplesect>
</para></internal>
    </detaileddescription>
    <location file="/mnt/workspace/Release_workflow_2016/gromacs-2016.3/src/gromacs/swap/swapcoords.cpp"/>
  </compounddef>
</doxygen>
