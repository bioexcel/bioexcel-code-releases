<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Gromacs: src/gromacs/timing/cyclecounter.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Gromacs
   &#160;<span id="projectnumber">2016.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.xhtml"><span>Modules</span></a></li>
      <li><a href="pages.xhtml"><span>Other&#160;Docs</span></a></li>
      <li><a href="namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="annotated.xhtml"><span>Classes</span></a></li>
      <li class="current"><a href="files.xhtml"><span>Files</span></a></li>
      <li><a href="examples.xhtml"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.xhtml"><span>File&#160;List</span></a></li>
      <li><a href="globals.xhtml"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_71392c6f4b1ed3a32ba5c064e868a1ba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_a798d384400d41a9e6864d9b1b8753fe.xhtml">gromacs</a></li><li class="navelem"><a class="el" href="dir_0b8ac6343fc955d2b71487bd84b8c4e5.xhtml">timing</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cyclecounter.h File Reference<div class="ingroups"><a class="el" href="group__group__libraryapi.xhtml">Library API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;config.h&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for cyclecounter.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="cyclecounter_8h__incl.svg" width="144" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>High-resolution timestamp or CPU clock cycle counters. </p>
<p>After reading the current value with <a class="el" href="cyclecounter_8h.xhtml#a2a7996b372df6309ac36d3b4cbbc58c3" title="Read CPU cycle counter. ">gmx_cycles_read()</a> you can add or subtract these numbers as normal integers of type gmx_cycles_t. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7b04e633389542df9f5535b05b873baa"><td class="memItemLeft" align="right" valign="top">typedef long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cyclecounter_8h.xhtml#a7b04e633389542df9f5535b05b873baa">gmx_cycles_t</a></td></tr>
<tr class="memdesc:a7b04e633389542df9f5535b05b873baa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer-like datatype for cycle counter values.  <a href="#a7b04e633389542df9f5535b05b873baa">More...</a><br/></td></tr>
<tr class="separator:a7b04e633389542df9f5535b05b873baa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2a7996b372df6309ac36d3b4cbbc58c3"><td class="memItemLeft" align="right" valign="top">static __inline__ <a class="el" href="cyclecounter_8h.xhtml#a7b04e633389542df9f5535b05b873baa">gmx_cycles_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cyclecounter_8h.xhtml#a2a7996b372df6309ac36d3b4cbbc58c3">gmx_cycles_read</a> (void)</td></tr>
<tr class="memdesc:a2a7996b372df6309ac36d3b4cbbc58c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read CPU cycle counter.  <a href="#a2a7996b372df6309ac36d3b4cbbc58c3">More...</a><br/></td></tr>
<tr class="separator:a2a7996b372df6309ac36d3b4cbbc58c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a104228c4fa44503c13741351d9e2d7eb"><td class="memItemLeft" align="right" valign="top">static __inline__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cyclecounter_8h.xhtml#a104228c4fa44503c13741351d9e2d7eb">gmx_cycles_have_counter</a> (void)</td></tr>
<tr class="memdesc:a104228c4fa44503c13741351d9e2d7eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if high-resolution cycle counters are available.  <a href="#a104228c4fa44503c13741351d9e2d7eb">More...</a><br/></td></tr>
<tr class="separator:a104228c4fa44503c13741351d9e2d7eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15e94a5a32400864b027b6d54c7963e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cyclecounter_8h.xhtml#a15e94a5a32400864b027b6d54c7963e7">gmx_cycles_calibrate</a> (double sampletime)</td></tr>
<tr class="memdesc:a15e94a5a32400864b027b6d54c7963e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate number of seconds per cycle tick on host.  <a href="#a15e94a5a32400864b027b6d54c7963e7">More...</a><br/></td></tr>
<tr class="separator:a15e94a5a32400864b027b6d54c7963e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a7b04e633389542df9f5535b05b873baa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef long <a class="el" href="cyclecounter_8h.xhtml#a7b04e633389542df9f5535b05b873baa">gmx_cycles_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Integer-like datatype for cycle counter values. </p>
<p>Depending on your system this will usually be something like long long, or a special cycle datatype from the system header files. It is NOT necessarily real processor cycles - many systems count in nanoseconds or a special external time register at fixed frequency (not the CPU freq.)</p>
<p>You can subtract or add gmx_cycle_t types just as normal integers, and if you run the calibration routine you can also multiply it with a factor to translate the cycle data to seconds. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a15e94a5a32400864b027b6d54c7963e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gmx_cycles_calibrate </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampletime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate number of seconds per cycle tick on host. </p>
<p>This routine runs a timer loop to calibrate the number of seconds per the units returned fro <a class="el" href="cyclecounter_8h.xhtml#a2a7996b372df6309ac36d3b4cbbc58c3" title="Read CPU cycle counter. ">gmx_cycles_read()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sampletime</td><td>Minimum real sample time. It takes some trial-and-error to find the correct delay loop size, so the total runtime of this routine is about twice this time. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of seconds per cycle unit. If it is not possible to calculate on this system (for whatever reason) the return value will be -1, so check that it is positive before using it. </dd></dl>

</div>
</div>
<a class="anchor" id="a104228c4fa44503c13741351d9e2d7eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ int gmx_cycles_have_counter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if high-resolution cycle counters are available. </p>
<p>Not all architectures provide any way to read timestep counters in the CPU, and on some it is broken. Although we refer to it as cycle counters, it is not necessarily given in units of cycles.</p>
<p>If you notice that system is missing, implement support for it, find out how to detect the system during preprocessing, and send us a patch.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if cycle counters are available, 0 if not.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This functions not need to be in the header for performance reasons, but it is very important that we get exactly the same detection as for <a class="el" href="cyclecounter_8h.xhtml#a2a7996b372df6309ac36d3b4cbbc58c3" title="Read CPU cycle counter. ">gmx_cycles_read()</a> routines. If you compile the library with one compiler, and then use a different one when later linking to the library it might happen that the library supports cyclecounters but not the headers, or vice versa. </dd></dl>

</div>
</div>
<a class="anchor" id="a2a7996b372df6309ac36d3b4cbbc58c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ <a class="el" href="cyclecounter_8h.xhtml#a7b04e633389542df9f5535b05b873baa">gmx_cycles_t</a> gmx_cycles_read </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read CPU cycle counter. </p>
<p>This routine returns an abstract datatype containing a cycle counter timestamp.</p>
<dl class="section return"><dt>Returns</dt><dd>Opaque data corresponding to a cycle reading.</dd></dl>
<p>Please note that on most systems it takes several cycles to read and return the cycle counters. If you are measuring small intervals, you can compensate for this time by calling the routine twice and calculating what the difference is. Subtract this from your other measurements to get an accurate result.</p>
<p>Use gmx_cycles_difference() to get a real number corresponding to the difference between two gmx_cycles_t values returned from this routine. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 13 2017 19:19:34 for Gromacs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
